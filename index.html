<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industry Matrix Dashboard - AIR Platform</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <style>
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce { animation: bounce 1s ease-in-out infinite; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .animate-slide-in { animation: slideIn 0.3s ease-out; }
        @keyframes fadeInUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-fade-in-up { animation: fadeInUp 0.5s ease-out forwards; }
        @keyframes flowPulse {
            0%, 100% { opacity: 0.4; }
            50% { opacity: 1; }
        }
        .flow-arrow { animation: flowPulse 2s ease-in-out infinite; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        const Dashboard = () => {
            const [activeTab, setActiveTab] = useState('agent');
            const [language, setLanguage] = useState('ko');
            const [zoom, setZoom] = useState(100);
            const [searchTerm, setSearchTerm] = useState('');
            const [clickedItem, setClickedItem] = useState(null);
            const [selectedIndustry, setSelectedIndustry] = useState(null);
            const [selectedWorkflow, setSelectedWorkflow] = useState(null);
            const [hoveredWorkflow, setHoveredWorkflow] = useState(null);
            
            const [isAdmin, setIsAdmin] = useState(() => localStorage.getItem('isAdmin') === 'true');
            const [showLoginModal, setShowLoginModal] = useState(false);
            const [password, setPassword] = useState('');
            const [loginError, setLoginError] = useState('');

            // íŽ¸ì§‘ ëª¨ë“œ ê´€ë ¨ state
            const [editMode, setEditMode] = useState(false);
            const [editingItem, setEditingItem] = useState(null);
            const [editValue, setEditValue] = useState('');
            const [showAddModal, setShowAddModal] = useState(false);
            const [addModalCell, setAddModalCell] = useState(null);
            const [newItemName, setNewItemName] = useState('');
            
            // ë°œí‘œìžë£Œ ê´€ë ¨ state
            const [showAddEventModal, setShowAddEventModal] = useState(false);
            const [newEventName, setNewEventName] = useState('');
            const [editingCell, setEditingCell] = useState(null);
            const [editCellValue, setEditCellValue] = useState('');
            const [editingEventName, setEditingEventName] = useState(null);
            const [editEventNameValue, setEditEventNameValue] = useState('');
            
            // Agent ë©”ëª¨ ìƒíƒœ
            const [agentMemos, setAgentMemos] = useState(() => {
                const saved = localStorage.getItem('agentMemosV1');
                return saved ? JSON.parse(saved) : {};
            });
            const [showMemoModal, setShowMemoModal] = useState(false);
            const [currentMemo, setCurrentMemo] = useState({ industry: '', workflow: '', agent: '', text: '' });
            
            // Agent ìƒ‰ìƒ ìƒíƒœ
            const [agentColors, setAgentColors] = useState(() => {
                const saved = localStorage.getItem('agentColorsV1');
                return saved ? JSON.parse(saved) : {};
            });
            
            const ADMIN_PASSWORD = 'air2024admin';
            const AGENT_DRIVE_LINK = 'https://drive.google.com/drive/folders/1emmH25lXfNHuJa-pQFk20Mb9GWljGTVc?usp=sharing';
            const SALESKIT_DRIVE_LINK = 'https://drive.google.com/drive/folders/1jcWds-T2b5JurKUx-no7HuIF46Qwcpnd?usp=sharing';
            const PRESENTATION_DRIVE_LINK = 'https://drive.google.com/drive/folders/10GLwu5Lyazv5V3o0w2Ii0ZrcfmBCfqr8?usp=sharing';

            // Google Picker API ì„¤ì •
            const GOOGLE_API_KEY = 'YOUR_API_KEY_HERE'; // Google Cloud Consoleì—ì„œ ë°œê¸‰
            const GOOGLE_CLIENT_ID = 'YOUR_CLIENT_ID_HERE'; // Google Cloud Consoleì—ì„œ ë°œê¸‰
            const AGENT_FOLDER_ID = '1emmH25lXfNHuJa-pQFk20Mb9GWljGTVc';
            const SALESKIT_FOLDER_ID = '1jcWds-T2b5JurKUx-no7HuIF46Qwcpnd';
            const PRESENTATION_FOLDER_ID = '10GLwu5Lyazv5V3o0w2Ii0ZrcfmBCfqr8';
            
            const [pickerApiLoaded, setPickerApiLoaded] = useState(false);
            const [googleToken, setGoogleToken] = useState(null);

            const translations = {
                ko: {
                    title: 'Industry Matrix Dashboard',
                    subtitle: 'ì‚°ì—…ë³„ AI Agent ë§¤íŠ¸ë¦­ìŠ¤ ëŒ€ì‹œë³´ë“œ',
                    agentTab: 'AI Agent',
                    saleskitTab: 'Saleskit',
                    presentationTab: 'ë°œí‘œìžë£Œ',
                    reset: 'ì´ˆê¸°í™”',
                    totalAgents: 'Total Agents',
                    agents: 'agents',
                    files: 'files',
                    searchPlaceholder: 'Agent ê²€ìƒ‰...',
                    noData: 'ì—†ìŒ',
                    cancel: 'ì·¨ì†Œ',
                    save: 'ì €ìž¥',
                    editMode: 'íŽ¸ì§‘ ëª¨ë“œ',
                    editComplete: 'íŽ¸ì§‘ ì™„ë£Œ',
                    addButton: 'ì¶”ê°€',
                    addModalTitle: 'í•­ëª© ì¶”ê°€',
                    enterName: 'ì´ë¦„ì„ ìž…ë ¥í•˜ì„¸ìš”',
                    editModeActive: 'íŽ¸ì§‘ ëª¨ë“œ í™œì„±í™”',
                    resetConfirm: 'ì´ˆê¸° ìƒíƒœë¡œ ë˜ëŒë¦¬ì‹œê² ìŠµë‹ˆê¹Œ?',
                    driveOpen: 'Google Drive ì—´ê¸°',
                    workflowLabel: 'Workflow',
                    industryLabel: 'Industry',
                    adminLogin: 'ê´€ë¦¬ìž ë¡œê·¸ì¸',
                    logout: 'ë¡œê·¸ì•„ì›ƒ',
                    password: 'ë¹„ë°€ë²ˆí˜¸',
                    login: 'ë¡œê·¸ì¸',
                    wrongPassword: 'ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤',
                    loginRequired: 'ê´€ë¦¬ìž ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤',
                    backToOverview: 'â† ì „ì²´ ë³´ê¸°',
                    clickForMap: 'ðŸš‡ ì‚°ì—…ëª… í´ë¦­ â†’ íŠ¹í™” Workflow Map',
                    workflowDiagram: 'ì›Œí¬í”Œë¡œìš° í”„ë¡œì„¸ìŠ¤',
                    clickWorkflow: 'ì›Œí¬í”Œë¡œìš° í´ë¦­ ì‹œ AI Agent ëª©ë¡ í‘œì‹œ',
                    clickToConnect: 'í´ë¦­ â†’ Google Drive',
                    commonWorkflowTitle: 'ê³µí†µ ì—…ë¬´ Workflow',
                    industryWorkflowTitle: 'ì‚°ì—… íŠ¹í™” Workflow Map',
                    agentList: 'AI Agent ëª©ë¡',
                    selectWorkflow: 'ìœ„ ì›Œí¬í”Œë¡œìš°ë¥¼ í´ë¦­í•˜ì—¬ Agent ëª©ë¡ì„ í™•ì¸í•˜ì„¸ìš”',
                    // ë°œí‘œìžë£Œ ê´€ë ¨
                    eventName: 'í–‰ì‚¬ëª…',
                    addEvent: '+ í–‰ì‚¬ ì¶”ê°€',
                    addEventTitle: 'ìƒˆ í–‰ì‚¬ ì¶”ê°€',
                    enterEventName: 'í–‰ì‚¬ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”',
                    deleteEvent: 'ì‚­ì œ',
                    months: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”', '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'],
                    presentationTitle: 'ì—°ê°„ ë°œí‘œìžë£Œ ì¼ì •',
                    presentationSubtitle: 'í–‰ì‚¬ë³„ ì›”ê°„ ë°œí‘œìžë£Œ í˜„í™©',
                    clickToEdit: 'í´ë¦­í•˜ì—¬ íŽ¸ì§‘',
                    industries: {
                        'FSI': 'FSI (ê¸ˆìœµ)',
                        'ì œì¡°': 'ì œì¡°',
                        'ìœ í†µ': 'ìœ í†µ',
                        'Emerging biz & Game': 'Emerging biz & Game',
                        'Public': 'Public (ê³µê³µ)',
                        'Telco&Media': 'Telco & Media',
                        'Vertical Enterprise': 'Vertical Enterprise'
                    },
                    workflowNames: {
                        'ê³ ê° ìƒë‹´': 'ê³ ê° ìƒë‹´', 'ë¬¸ì„œ ê´€ë¦¬': 'ë¬¸ì„œ ê´€ë¦¬', 'ë°ì´í„° ë¶„ì„': 'ë°ì´í„° ë¶„ì„', 'ì˜ì‚¬ê²°ì • ì§€ì›': 'ì˜ì‚¬ê²°ì • ì§€ì›',
                        'ë³´ê³ ì„œ ìƒì„±': 'ë³´ê³ ì„œ ìƒì„±', 'HR í”„ë¡œì„¸ìŠ¤': 'HR í”„ë¡œì„¸ìŠ¤',
                        'ê³ ê° ì˜¨ë³´ë”©': 'ê³ ê° ì˜¨ë³´ë”©', 'ëŒ€ì¶œ/ì‹¬ì‚¬': 'ëŒ€ì¶œ/ì‹¬ì‚¬', 'ìžì‚° ê´€ë¦¬': 'ìžì‚° ê´€ë¦¬', 'ê³ ê° ì´íƒˆ ë°©ì§€': 'ê³ ê° ì´íƒˆ ë°©ì§€', 'ê´‘ê³  ìµœì í™”': 'ê´‘ê³  ìµœì í™”',
                        'ìˆ˜ìš” ì˜ˆì¸¡': 'ìˆ˜ìš” ì˜ˆì¸¡', 'ìƒì‚° ê³„íš': 'ìƒì‚° ê³„íš', 'í’ˆì§ˆ ê´€ë¦¬': 'í’ˆì§ˆ ê´€ë¦¬', 'ì„¤ë¹„ ìœ ì§€ë³´ìˆ˜': 'ì„¤ë¹„ ìœ ì§€ë³´ìˆ˜',
                        'ìž¬ê³  ê´€ë¦¬': 'ìž¬ê³  ê´€ë¦¬', 'ë§¤ìž¥ ìš´ì˜': 'ë§¤ìž¥ ìš´ì˜', 'ê³ ê° ê²½í—˜': 'ê³ ê° ê²½í—˜', 'ì˜´ë‹ˆì±„ë„': 'ì˜´ë‹ˆì±„ë„',
                        'ê²Œìž„ ê°œë°œ': 'ê²Œìž„ ê°œë°œ', 'ì½˜í…ì¸  ì œìž‘': 'ì½˜í…ì¸  ì œìž‘', 'ì»¤ë®¤ë‹ˆí‹° ê´€ë¦¬': 'ì»¤ë®¤ë‹ˆí‹° ê´€ë¦¬', 'ìˆ˜ìµí™” ì „ëžµ': 'ìˆ˜ìµí™” ì „ëžµ',
                        'ë¯¼ì› ì²˜ë¦¬': 'ë¯¼ì› ì²˜ë¦¬', 'ì •ì±… ë¶„ì„': 'ì •ì±… ë¶„ì„', 'ì˜ˆì‚° ê´€ë¦¬': 'ì˜ˆì‚° ê´€ë¦¬', 'ê³µê³µ ì„œë¹„ìŠ¤': 'ê³µê³µ ì„œë¹„ìŠ¤',
                        'ì½˜í…ì¸  ì¶”ì²œ': 'ì½˜í…ì¸  ì¶”ì²œ', 'ë„¤íŠ¸ì›Œí¬ ìµœì í™”': 'ë„¤íŠ¸ì›Œí¬ ìµœì í™”',
                        'êµ¬ë§¤ ê´€ë¦¬': 'êµ¬ë§¤ ê´€ë¦¬', 'ì§€ì‹ ê´€ë¦¬': 'ì§€ì‹ ê´€ë¦¬', 'í”„ë¡œì„¸ìŠ¤ ìžë™í™”': 'í”„ë¡œì„¸ìŠ¤ ìžë™í™”'
                    },
                    saleskitCategories: {
                        'ì œì•ˆì„œ': 'ì œì•ˆì„œ', 'Brochure': 'Brochure', 'Customer Case': 'Customer Case',
                        '1page deck': '1page deck', 'PR FAQ': 'PR FAQ', 'Charter': 'Charter', 'Demo ì˜ìƒ': 'Demo ì˜ìƒ'
                    }
                },
                en: {
                    title: 'Industry Matrix Dashboard',
                    subtitle: 'Industry AI Agent Matrix Dashboard',
                    agentTab: 'AI Agent',
                    saleskitTab: 'Saleskit',
                    presentationTab: 'Presentations',
                    reset: 'Reset',
                    totalAgents: 'Total Agents',
                    agents: 'agents',
                    files: 'files',
                    searchPlaceholder: 'Search agents...',
                    noData: 'None',
                    cancel: 'Cancel',
                    save: 'Save',
                    editMode: 'Edit Mode',
                    editComplete: 'Done',
                    addButton: 'Add',
                    addModalTitle: 'Add Item',
                    enterName: 'Enter name',
                    editModeActive: 'Edit mode active',
                    resetConfirm: 'Reset to initial state?',
                    driveOpen: 'Opening Drive',
                    workflowLabel: 'Workflow',
                    industryLabel: 'Industry',
                    adminLogin: 'Admin Login',
                    logout: 'Logout',
                    password: 'Password',
                    login: 'Login',
                    wrongPassword: 'Incorrect password',
                    loginRequired: 'Admin login required',
                    backToOverview: 'â† Back',
                    clickForMap: 'ðŸš‡ Click Industry â†’ Workflow Map',
                    workflowDiagram: 'Workflow Process',
                    clickWorkflow: 'Click workflow to show AI Agents',
                    clickToConnect: 'Click â†’ Google Drive',
                    commonWorkflowTitle: 'Common Workflows',
                    industryWorkflowTitle: 'Industry-specific Workflow Map',
                    agentList: 'AI Agent List',
                    selectWorkflow: 'Click a workflow above to view agents',
                    eventName: 'Event Name',
                    addEvent: '+ Add Event',
                    addEventTitle: 'Add New Event',
                    enterEventName: 'Enter event name',
                    deleteEvent: 'Delete',
                    months: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    presentationTitle: 'Annual Presentation Schedule',
                    presentationSubtitle: 'Monthly presentation status by event',
                    clickToEdit: 'Click to edit',
                    industries: {
                        'FSI': 'FSI (Finance)',
                        'ì œì¡°': 'Manufacturing',
                        'ìœ í†µ': 'Retail',
                        'Emerging biz & Game': 'Emerging biz & Game',
                        'Public': 'Public Sector',
                        'Telco&Media': 'Telco & Media',
                        'Vertical Enterprise': 'Vertical Enterprise'
                    },
                    workflowNames: {
                        'ê³ ê° ìƒë‹´': 'Customer Service', 'ë¬¸ì„œ ê´€ë¦¬': 'Document Mgmt', 'ë°ì´í„° ë¶„ì„': 'Data Analysis', 'ì˜ì‚¬ê²°ì • ì§€ì›': 'Decision Support',
                        'ë³´ê³ ì„œ ìƒì„±': 'Report Generation', 'HR í”„ë¡œì„¸ìŠ¤': 'HR Process',
                        'ê³ ê° ì˜¨ë³´ë”©': 'Onboarding', 'ëŒ€ì¶œ/ì‹¬ì‚¬': 'Loan Review', 'ìžì‚° ê´€ë¦¬': 'Asset Mgmt', 'ê³ ê° ì´íƒˆ ë°©ì§€': 'Churn Prevention', 'ê´‘ê³  ìµœì í™”': 'Ad Optimization',
                        'ìˆ˜ìš” ì˜ˆì¸¡': 'Demand Forecast', 'ìƒì‚° ê³„íš': 'Production Plan', 'í’ˆì§ˆ ê´€ë¦¬': 'Quality Control', 'ì„¤ë¹„ ìœ ì§€ë³´ìˆ˜': 'Maintenance',
                        'ìž¬ê³  ê´€ë¦¬': 'Inventory Mgmt', 'ë§¤ìž¥ ìš´ì˜': 'Store Ops', 'ê³ ê° ê²½í—˜': 'Customer Exp', 'ì˜´ë‹ˆì±„ë„': 'Omnichannel',
                        'ê²Œìž„ ê°œë°œ': 'Game Dev', 'ì½˜í…ì¸  ì œìž‘': 'Content Creation', 'ì»¤ë®¤ë‹ˆí‹° ê´€ë¦¬': 'Community Mgmt', 'ìˆ˜ìµí™” ì „ëžµ': 'Monetization',
                        'ë¯¼ì› ì²˜ë¦¬': 'Civil Affairs', 'ì •ì±… ë¶„ì„': 'Policy Analysis', 'ì˜ˆì‚° ê´€ë¦¬': 'Budget Mgmt', 'ê³µê³µ ì„œë¹„ìŠ¤': 'Public Service',
                        'ì½˜í…ì¸  ì¶”ì²œ': 'Content Recommend', 'ë„¤íŠ¸ì›Œí¬ ìµœì í™”': 'Network Opt',
                        'êµ¬ë§¤ ê´€ë¦¬': 'Procurement', 'ì§€ì‹ ê´€ë¦¬': 'Knowledge Mgmt', 'í”„ë¡œì„¸ìŠ¤ ìžë™í™”': 'Process Auto'
                    },
                    saleskitCategories: {
                        'ì œì•ˆì„œ': 'Proposal', 'Brochure': 'Brochure', 'Customer Case': 'Customer Case',
                        '1page deck': '1-Page Deck', 'PR FAQ': 'PR FAQ', 'Charter': 'Charter', 'Demo ì˜ìƒ': 'Demo Video'
                    }
                }
            };

            const t = translations[language];
            const translateWorkflow = (wf) => t.workflowNames[wf] || t.saleskitCategories[wf] || wf;
            const translateIndustry = (ind) => t.industries[ind] || ind;

            const handleLogin = () => {
                if (password === ADMIN_PASSWORD) {
                    setIsAdmin(true);
                    localStorage.setItem('isAdmin', 'true');
                    setShowLoginModal(false);
                    setPassword('');
                    setLoginError('');
                } else {
                    setLoginError(t.wrongPassword);
                }
            };

            const handleLogout = () => {
                setIsAdmin(false);
                setEditMode(false);
                localStorage.removeItem('isAdmin');
            };

            const handleEditModeToggle = () => {
                if (!isAdmin) {
                    setShowLoginModal(true);
                } else {
                    setEditMode(!editMode);
                }
            };

            // AI Agent / Saleskit íŽ¸ì§‘ í•¨ìˆ˜ë“¤
            const handleDeleteItem = (industry, workflow, itemIndex) => {
                if (!isAdmin) return;
                
                const items = currentData[industry]?.[workflow] || [];
                const itemName = items[itemIndex] || '';
                
                if (!confirm(`"${itemName}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                    return;
                }
                
                if (activeTab === 'agent') {
                    setAgentData(prev => {
                        const newData = JSON.parse(JSON.stringify(prev));
                        newData[industry][workflow].splice(itemIndex, 1);
                        if (newData[industry][workflow].length === 0) {
                            newData[industry][workflow] = ['ì—†ìŒ'];
                        }
                        return newData;
                    });
                } else if (activeTab === 'saleskit') {
                    setSaleskitData(prev => {
                        const newData = JSON.parse(JSON.stringify(prev));
                        newData[industry][workflow].splice(itemIndex, 1);
                        if (newData[industry][workflow].length === 0) {
                            newData[industry][workflow] = ['ì—†ìŒ'];
                        }
                        return newData;
                    });
                }
            };

            const handleEditItem = (industry, workflow, itemIndex, currentName) => {
                if (!isAdmin) return;
                const color = getAgentColor(industry, workflow, currentName);
                setEditingItem({ industry, workflow, itemIndex, color });
                setEditValue(currentName);
            };

            const handleSaveEdit = () => {
                if (!isAdmin) return;
                if (editingItem && editValue.trim()) {
                    const { industry, workflow, itemIndex, color } = editingItem;
                    
                    if (activeTab === 'agent') {
                        const oldName = agentData[industry][workflow][itemIndex];
                        const newName = editValue.trim();
                        
                        // ì´ë¦„ì´ ë°”ë€Œë©´ ë©”ëª¨ì™€ ìƒ‰ìƒë„ í•¨ê»˜ ì´ë™
                        if (oldName !== newName) {
                            const oldKey = getMemoKey(industry, workflow, oldName);
                            const newKey = getMemoKey(industry, workflow, newName);
                            
                            // ë©”ëª¨ ì´ë™
                            if (agentMemos[oldKey]) {
                                setAgentMemos(prev => {
                                    const newMemos = { ...prev };
                                    newMemos[newKey] = newMemos[oldKey];
                                    delete newMemos[oldKey];
                                    return newMemos;
                                });
                            }
                            
                            // ìƒ‰ìƒ ì´ë™ ë° ì—…ë°ì´íŠ¸
                            setAgentColors(prev => {
                                const newColors = { ...prev };
                                if (color) {
                                    newColors[newKey] = color;
                                }
                                delete newColors[oldKey];
                                return newColors;
                            });
                        } else if (color) {
                            // ì´ë¦„ì€ ê°™ì§€ë§Œ ìƒ‰ìƒë§Œ ë³€ê²½
                            setAgentColor(industry, workflow, newName, color);
                        }
                        
                        setAgentData(prev => {
                            const newData = JSON.parse(JSON.stringify(prev));
                            newData[industry][workflow][itemIndex] = newName;
                            return newData;
                        });
                    } else if (activeTab === 'saleskit') {
                        setSaleskitData(prev => {
                            const newData = JSON.parse(JSON.stringify(prev));
                            newData[industry][workflow][itemIndex] = editValue.trim();
                            return newData;
                        });
                    }
                }
                setEditingItem(null);
                setEditValue('');
            };

            const handleCancelEdit = () => {
                setEditingItem(null);
                setEditValue('');
            };

            const handleOpenAddModal = (industry, workflow) => {
                if (!isAdmin) return;
                
                // Google Drive ì—´ê¸°
                const driveLink = activeTab === 'agent' ? AGENT_DRIVE_LINK : SALESKIT_DRIVE_LINK;
                window.open(driveLink, '_blank', 'width=1200,height=800');
                
                // ëª¨ë‹¬ ì—´ê¸°
                setAddModalCell({ industry, workflow });
                setNewItemName('');
                setShowAddModal(true);
            };

            const handleAddItem = () => {
                if (!isAdmin) return;
                if (addModalCell && newItemName.trim()) {
                    const { industry, workflow } = addModalCell;
                    
                    if (activeTab === 'agent') {
                        setAgentData(prev => {
                            const newData = JSON.parse(JSON.stringify(prev));
                            if (newData[industry][workflow][0] === 'ì—†ìŒ') {
                                newData[industry][workflow] = [newItemName.trim()];
                            } else {
                                newData[industry][workflow].push(newItemName.trim());
                            }
                            return newData;
                        });
                    } else if (activeTab === 'saleskit') {
                        setSaleskitData(prev => {
                            const newData = JSON.parse(JSON.stringify(prev));
                            if (newData[industry][workflow][0] === 'ì—†ìŒ') {
                                newData[industry][workflow] = [newItemName.trim()];
                            } else {
                                newData[industry][workflow].push(newItemName.trim());
                            }
                            return newData;
                        });
                    }
                    
                    setShowAddModal(false);
                    setAddModalCell(null);
                    setNewItemName('');
                }
            };

            // Google Picker API ì´ˆê¸°í™”
            useEffect(() => {
                if (window.gapi) {
                    window.gapi.load('picker', () => {
                        setPickerApiLoaded(true);
                    });
                }
            }, []);

            // Google ì¸ì¦
            const handleAuthClick = () => {
                const client = window.google.accounts.oauth2.initTokenClient({
                    client_id: GOOGLE_CLIENT_ID,
                    scope: 'https://www.googleapis.com/auth/drive.readonly',
                    callback: (tokenResponse) => {
                        setGoogleToken(tokenResponse.access_token);
                    },
                });
                client.requestAccessToken();
            };

            // Google Picker ì—´ê¸°
            const openPicker = () => {
                if (!pickerApiLoaded || !googleToken) {
                    handleAuthClick();
                    setTimeout(() => openPicker(), 1000);
                    return;
                }

                const folderId = activeTab === 'agent' ? AGENT_FOLDER_ID : SALESKIT_FOLDER_ID;
                
                const picker = new window.google.picker.PickerBuilder()
                    .addView(
                        new window.google.picker.DocsView()
                            .setParent(folderId)
                            .setIncludeFolders(false)
                    )
                    .setOAuthToken(googleToken)
                    .setDeveloperKey(GOOGLE_API_KEY)
                    .setCallback(pickerCallback)
                    .setTitle('íŒŒì¼ ì„ íƒ')
                    .build();
                
                picker.setVisible(true);
            };

            // Pickerì—ì„œ íŒŒì¼ ì„ íƒ ì‹œ ì½œë°±
            const pickerCallback = (data) => {
                if (data.action === window.google.picker.Action.PICKED) {
                    const file = data.docs[0];
                    setNewItemName(file.name);
                }
            };

            // Add ë²„íŠ¼ì—ì„œ Picker ì‚¬ìš©
            const handleOpenAddModalWithPicker = (industry, workflow) => {
                if (!isAdmin) return;
                
                setAddModalCell({ industry, workflow });
                setNewItemName('');
                setShowAddModal(true);
                
                // API í‚¤ê°€ ì„¤ì •ë˜ì–´ ìžˆìœ¼ë©´ Picker ì‚¬ìš©
                if (GOOGLE_API_KEY !== 'YOUR_API_KEY_HERE' && GOOGLE_CLIENT_ID !== 'YOUR_CLIENT_ID_HERE') {
                    setTimeout(() => openPicker(), 300);
                } else {
                    // API í‚¤ê°€ ì—†ìœ¼ë©´ Drive ë§í¬ë§Œ ì—´ê¸°
                    const driveLink = activeTab === 'agent' ? AGENT_DRIVE_LINK : SALESKIT_DRIVE_LINK;
                    window.open(driveLink, '_blank', 'width=1200,height=800');
                }
            };

            // handleResetDataëŠ” ì•„ëž˜ì— ì •ì˜ë¨ (ì¤‘ë³µ ì œê±°)


            // ê³µí†µ ì›Œí¬í”Œë¡œìš° - ë³´ê³ ì„œ ìƒì„±, HR í”„ë¡œì„¸ìŠ¤ ì¶”ê°€
            const commonWorkflows = ['ê³ ê° ìƒë‹´', 'ë¬¸ì„œ ê´€ë¦¬', 'ë°ì´í„° ë¶„ì„', 'ì˜ì‚¬ê²°ì • ì§€ì›', 'ë³´ê³ ì„œ ìƒì„±', 'HR í”„ë¡œì„¸ìŠ¤'];

            // ì‚°ì—…ë³„ íŠ¹í™” ì›Œí¬í”Œë¡œìš°
            const industrySpecificWorkflows = {
                'FSI': ['ê³ ê° ì˜¨ë³´ë”©', 'ëŒ€ì¶œ/ì‹¬ì‚¬', 'ìžì‚° ê´€ë¦¬', 'ê³ ê° ì´íƒˆ ë°©ì§€', 'ê´‘ê³  ìµœì í™”'],
                'ì œì¡°': ['ìˆ˜ìš” ì˜ˆì¸¡', 'ìƒì‚° ê³„íš', 'í’ˆì§ˆ ê´€ë¦¬', 'ì„¤ë¹„ ìœ ì§€ë³´ìˆ˜'],
                'ìœ í†µ': ['ìž¬ê³  ê´€ë¦¬', 'ë§¤ìž¥ ìš´ì˜', 'ê³ ê° ê²½í—˜', 'ì˜´ë‹ˆì±„ë„', 'ê³ ê° ì´íƒˆ ë°©ì§€', 'ê´‘ê³  ìµœì í™”'],
                'Emerging biz & Game': ['ê²Œìž„ ê°œë°œ', 'ì½˜í…ì¸  ì œìž‘', 'ì»¤ë®¤ë‹ˆí‹° ê´€ë¦¬', 'ìˆ˜ìµí™” ì „ëžµ', 'ê³ ê° ì´íƒˆ ë°©ì§€'],
                'Public': ['ë¯¼ì› ì²˜ë¦¬', 'ì •ì±… ë¶„ì„', 'ì˜ˆì‚° ê´€ë¦¬', 'ê³µê³µ ì„œë¹„ìŠ¤'],
                'Telco&Media': ['ì½˜í…ì¸  ì¶”ì²œ', 'ë„¤íŠ¸ì›Œí¬ ìµœì í™”', 'ê³ ê° ì´íƒˆ ë°©ì§€', 'ê´‘ê³  ìµœì í™”'],
                'Vertical Enterprise': ['êµ¬ë§¤ ê´€ë¦¬', 'ì§€ì‹ ê´€ë¦¬', 'í”„ë¡œì„¸ìŠ¤ ìžë™í™”']
            };

            // Agent ë°ì´í„° - ë³´ê³ ì„œ ìƒì„±, HR í”„ë¡œì„¸ìŠ¤ ì¶”ê°€
            const initialAgentData = {
                'FSI': {
                    'ê³ ê° ìƒë‹´': ['Customer Service Assistant', 'Asen Chatbot', 'AIBuddiesëžœë¤'],
                    'ë¬¸ì„œ ê´€ë¦¬': ['Google Workspace Assistant', 'Brief / ë¸Œë¦¬í”„', 'Sample'],
                    'ë°ì´í„° ë¶„ì„': ['SQL agent', 'Market Intelligence Assistant', 'PnL', 'Strategic Thinking Assistant'],
                    'ì˜ì‚¬ê²°ì • ì§€ì›': ['Strategic Thinking Assistant', 'Financial Operations Assistant', 'Market Intelligence Assistant'],
                    'ë³´ê³ ì„œ ìƒì„±': ['Presentation Assistant', 'Brief / ë¸Œë¦¬í”„', 'Financial Operations Assistant'],
                    'HR í”„ë¡œì„¸ìŠ¤': ['HR Analytics', 'Hiring Assistant', 'Onboarding Success Assistant'],
                    'ê³ ê° ì˜¨ë³´ë”©': ['Tender Assistance', 'Customer Service Assistant', 'Financial Operations Assistant'],
                    'ëŒ€ì¶œ/ì‹¬ì‚¬': ['Financial Operations Assistant', 'Brand Context Analyzer', 'Negotiation EA', 'Advanced Vendor Assistant'],
                    'ìžì‚° ê´€ë¦¬': ['Financial Planning Futurism', 'PnL', 'Market Intelligence Assistant', 'Strategic Thinking Assistant'],
                    'ê³ ê° ì´íƒˆ ë°©ì§€': ['Brand Context Analyzer', 'Market Intelligence Assistant'],
                    'ê´‘ê³  ìµœì í™”': ['Marketing Campaign Assistant', 'Financial Operations Assistant']
                },
                'ì œì¡°': {
                    'ê³ ê° ìƒë‹´': ['Customer Service Assistant', 'ê¸´ê¸‰í•œì¼ ASAP_bot'],
                    'ë¬¸ì„œ ê´€ë¦¬': ['Google Workspace ì›Œí¬ìŠ¤íŽ˜ì´ìŠ¤', 'Brief / ë¸Œë¦¬í”„'],
                    'ë°ì´í„° ë¶„ì„': ['SQL agent', 'Market Intelligence Assistant', 'Strategic Thinking Assistant'],
                    'ì˜ì‚¬ê²°ì • ì§€ì›': ['Strategic Thinking Assistant', 'OKR ì½”ì¹˜ë‹˜'],
                    'ë³´ê³ ì„œ ìƒì„±': ['Presentation Assistant', 'Brief / ë¸Œë¦¬í”„', 'Strategic Thinking Assistant'],
                    'HR í”„ë¡œì„¸ìŠ¤': ['HR Analytics', 'Onboarding Success Assistant', 'OKR ì½”ì¹˜ë‹˜'],
                    'ìˆ˜ìš” ì˜ˆì¸¡': ['Market Intelligence Assistant', 'Google Workspace ì›Œí¬ìŠ¤íŽ˜ì´ìŠ¤', 'Strategic Thinking Assistant', 'SQL agent'],
                    'ìƒì‚° ê³„íš': ['Onboarding Success Assistant', 'Brief / ë¸Œë¦¬í”„', 'ê¸´ê¸‰í•œ ì›Œí¬ì±—', 'multi agents', 'SQL agent'],
                    'í’ˆì§ˆ ê´€ë¦¬': ['IT Ops & Comm Analyzer', 'Sample', 'Strategic Thinking Assistant', 'Market Intelligence Assistant', 'OKR ì½”ì¹˜ë‹˜'],
                    'ì„¤ë¹„ ìœ ì§€ë³´ìˆ˜': ['IT Ops & Comm Analyzer', 'AIBuddiesëžœë¤', 'Strategic Thinking Assistant', 'multi agents', 'ê¸´ê¸‰í•œì¼ ASAP_bot']
                },
                'ìœ í†µ': {
                    'ê³ ê° ìƒë‹´': ['Customer Service Assistant', 'Asen Chatbot', 'AIBuddiesëžœë¤', 'Bar Master'],
                    'ë¬¸ì„œ ê´€ë¦¬': ['Google Workspace Assistant', 'content_CURATOR'],
                    'ë°ì´í„° ë¶„ì„': ['SQL agent', 'Market Intelligence Assistant', 'Strategic Thinking Assistant'],
                    'ì˜ì‚¬ê²°ì • ì§€ì›': ['Strategic Thinking Assistant', 'Market Intelligence Assistant'],
                    'ë³´ê³ ì„œ ìƒì„±': ['Presentation Assistant', 'content_CURATOR', 'Brief / ë¸Œë¦¬í”„'],
                    'HR í”„ë¡œì„¸ìŠ¤': ['HR Analytics', 'Hiring Assistant', 'Onboarding Success Assistant'],
                    'ìž¬ê³  ê´€ë¦¬': ['SQL agent', 'Strategic Thinking Assistant', 'Market Intelligence Assistant'],
                    'ë§¤ìž¥ ìš´ì˜': ['Onboarding Success Assistant', 'ê¸´ê¸‰í•œì¼ ASAP_bot', 'IT Ops & Comm Analyzer'],
                    'ê³ ê° ê²½í—˜': ['Customer Service Assistant', 'Brand Context Analyzer', 'Asen Chatbot'],
                    'ì˜´ë‹ˆì±„ë„': ['Google Workspace Assistant', 'multi agents', 'Marketing Campaign Assistant'],
                    'ê³ ê° ì´íƒˆ ë°©ì§€': ['Brand Context Analyzer', 'Market Intelligence Assistant', 'Customer Service Assistant'],
                    'ê´‘ê³  ìµœì í™”': ['Marketing Campaign Assistant', 'Brand Context Analyzer', 'Market Intelligence Assistant']
                },
                'Emerging biz & Game': {
                    'ê³ ê° ìƒë‹´': ['Customer Service Assistant', 'Asen Chatbot', 'AIBuddiesëžœë¤'],
                    'ë¬¸ì„œ ê´€ë¦¬': ['Google Workspace Assistant', 'content_CURATOR', 'Brief / ë¸Œë¦¬í”„'],
                    'ë°ì´í„° ë¶„ì„': ['SQL agent', 'Market Intelligence Assistant', 'Strategic Thinking Assistant'],
                    'ì˜ì‚¬ê²°ì • ì§€ì›': ['Strategic Thinking Assistant', 'Market Intelligence Assistant', 'OKR ì½”ì¹˜ë‹˜'],
                    'ë³´ê³ ì„œ ìƒì„±': ['Presentation Assistant', '[NMT] LinkedIn í¬ìŠ¤íŠ¸ ì•±', 'content_CURATOR'],
                    'HR í”„ë¡œì„¸ìŠ¤': ['HR Analytics', 'Magazine HR - Sirage', 'Onboarding Success Assistant'],
                    'ê²Œìž„ ê°œë°œ': ['multi agents', 'Strategic Thinking Assistant', 'IT Ops & Comm Analyzer'],
                    'ì½˜í…ì¸  ì œìž‘': ['content_CURATOR', 'Presentation Assistant', 'Magazine HR - Sirage', '[NMT] LinkedIn í¬ìŠ¤íŠ¸ ì•±'],
                    'ì»¤ë®¤ë‹ˆí‹° ê´€ë¦¬': ['Asen Chatbot', 'AIBuddiesëžœë¤', 'Customer Service Assistant'],
                    'ìˆ˜ìµí™” ì „ëžµ': ['Market Intelligence Assistant', 'PnL', 'Financial Operations Assistant', 'Strategic Thinking Assistant'],
                    'ê³ ê° ì´íƒˆ ë°©ì§€': ['Brand Context Analyzer', 'Market Intelligence Assistant', 'Customer Service Assistant']
                },
                'Public': {
                    'ê³ ê° ìƒë‹´': ['Customer Service Assistant', 'Asen Chatbot', 'AIBuddiesëžœë¤'],
                    'ë¬¸ì„œ ê´€ë¦¬': ['Google Workspace Assistant', 'content_CURATOR', 'Brief / ë¸Œë¦¬í”„', 'Sample'],
                    'ë°ì´í„° ë¶„ì„': ['SQL agent', 'Strategic Thinking Assistant', 'Market Intelligence Assistant'],
                    'ì˜ì‚¬ê²°ì • ì§€ì›': ['Strategic Thinking Assistant', 'Market Intelligence Assistant', 'OKR ì½”ì¹˜ë‹˜'],
                    'ë³´ê³ ì„œ ìƒì„±': ['Presentation Assistant', 'Brief / ë¸Œë¦¬í”„', '[NMT] LinkedIn í¬ìŠ¤íŠ¸ ì•±'],
                    'HR í”„ë¡œì„¸ìŠ¤': ['HR Analytics', 'Hiring Assistant', 'Onboarding Success Assistant', 'OKR ì½”ì¹˜ë‹˜'],
                    'ë¯¼ì› ì²˜ë¦¬': ['Customer Service Assistant', 'Asen Chatbot', 'ê¸´ê¸‰í•œì¼ ASAP_bot', 'Sample'],
                    'ì •ì±… ë¶„ì„': ['Strategic Thinking Assistant', 'Market Intelligence Assistant', 'Brand Context Analyzer'],
                    'ì˜ˆì‚° ê´€ë¦¬': ['Financial Operations Assistant', 'PnL', 'SQL agent'],
                    'ê³µê³µ ì„œë¹„ìŠ¤': ['Customer Service Assistant', 'Asen Chatbot', 'Presentation Assistant', 'content_CURATOR']
                },
                'Telco&Media': {
                    'ê³ ê° ìƒë‹´': ['Customer Service Assistant', 'Asen Chatbot', 'AIBuddiesëžœë¤'],
                    'ë¬¸ì„œ ê´€ë¦¬': ['Google Workspace Assistant', 'content_CURATOR'],
                    'ë°ì´í„° ë¶„ì„': ['SQL agent', 'Market Intelligence Assistant', 'Strategic Thinking Assistant'],
                    'ì˜ì‚¬ê²°ì • ì§€ì›': ['Strategic Thinking Assistant', 'Market Intelligence Assistant'],
                    'ë³´ê³ ì„œ ìƒì„±': ['Presentation Assistant', '[NMT] LinkedIn í¬ìŠ¤íŠ¸ ì•±', 'content_CURATOR'],
                    'HR í”„ë¡œì„¸ìŠ¤': ['HR Analytics', 'Hiring Assistant', 'Magazine HR - Sirage'],
                    'ì½˜í…ì¸  ì¶”ì²œ': ['Brand Context Analyzer', 'Market Intelligence Assistant', 'content_CURATOR', 'Presentation Assistant', 'Sales Enablement Assistant'],
                    'ë„¤íŠ¸ì›Œí¬ ìµœì í™”': ['IT Ops & Comm Analyzer', 'SQL agent', 'Strategic Thinking Assistant', 'IT Strategy Newsletter', 'multi agents', 'Campaign: MAE Assistant'],
                    'ê³ ê° ì´íƒˆ ë°©ì§€': ['Brand Context Analyzer', 'Market Intelligence Assistant', 'Marketing Campaign Assistant', 'Negotiation EA', 'Campaign: MAE Assistant', 'Sales Enablement Assistant'],
                    'ê´‘ê³  ìµœì í™”': ['Marketing Campaign Assistant', 'Brand Context Analyzer', 'Financial Operations Assistant', 'Advanced Vendor Assistant', 'Market Intelligence Assistant', 'PnL']
                },
                'Vertical Enterprise': {
                    'ê³ ê° ìƒë‹´': ['Customer Service Assistant', 'Asen Chatbot', 'Sample', 'Bar Master'],
                    'ë¬¸ì„œ ê´€ë¦¬': ['Google Workspace Assistant', 'Google Workspace ì›Œí¬ìŠ¤íŽ˜ì´ìŠ¤', 'content_CURATOR', 'Brief / ë¸Œë¦¬í”„', 'SQL agent', 'Sample', 'multi agents'],
                    'ë°ì´í„° ë¶„ì„': ['SQL agent', 'Strategic Thinking Assistant', 'Market Intelligence Assistant'],
                    'ì˜ì‚¬ê²°ì • ì§€ì›': ['Strategic Thinking Assistant', 'Market Intelligence Assistant', 'OKR ì½”ì¹˜ë‹˜'],
                    'ë³´ê³ ì„œ ìƒì„±': ['Presentation Assistant', 'Brief / ë¸Œë¦¬í”„', '[NMT] LinkedIn í¬ìŠ¤íŠ¸ ì•±', 'content_CURATOR'],
                    'HR í”„ë¡œì„¸ìŠ¤': ['HR Analytics', 'Hiring Assistant', '[NMT] LinkedIn í¬ìŠ¤íŠ¸ ì•±', 'Onboarding Success Assistant', 'Magazine HR - Sirage', 'OKR ì½”ì¹˜ë‹˜'],
                    'êµ¬ë§¤ ê´€ë¦¬': ['ê¸´ê¸‰í•œì¼ ASAP_bot', 'In house Administrative Assistant Agent v3', 'Advanced Vendor Assistant', 'Negotiation EA', 'Tender Assistance', 'Brief / ë¸Œë¦¬í”„'],
                    'ì§€ì‹ ê´€ë¦¬': ['content_CURATOR', 'Strategic Thinking Assistant', 'ì¼ì§€', 'í¬ìŠ¤í„° ëŒ€ë³€ ì›Œí¬í”Œë¡œìš°', 'Asen Chatbot', 'Sample', 'Bar Master'],
                    'í”„ë¡œì„¸ìŠ¤ ìžë™í™”': ['multi agents', 'Brief / ë¸Œë¦¬í”„', 'Google Workspace ì›Œí¬ìŠ¤íŽ˜ì´ìŠ¤']
                }
            };

            const initialSaleskitData = {
                'FSI': {
                    'ì œì•ˆì„œ': ['FSI_Proposal_Q1_2024.pptx', 'Banking_Solution_Proposal.pdf', 'Insurance_Platform_RFP.docx'],
                    'Brochure': ['FSI_Product_Brochure_2024.pdf', 'Digital_Banking_Brochure.pdf'],
                    'Customer Case': ['KB_Bank_Case_Study.pdf', 'Samsung_Life_Success_Story.pdf'],
                    '1page deck': ['FSI_Overview_1pager.pdf'],
                    'PR FAQ': ['FSI_AI_Platform_FAQ.pdf'],
                    'Charter': ['FSI_Project_Charter_2024.pdf'],
                    'Demo ì˜ìƒ': ['FSI_Banking_Platform_Demo.mp4', 'AI_Risk_Management_Demo.mp4']
                },
                'ì œì¡°': {
                    'ì œì•ˆì„œ': ['Manufacturing_AI_Proposal.pptx', 'Smart_Factory_Solution.pdf'],
                    'Brochure': ['ì œì¡°_ì‚°ì—…_ë¸Œë¡œì…”_2024.pdf'],
                    'Customer Case': ['Hyundai_Motor_Case.pdf', 'Samsung_Electronics_Story.pdf'],
                    '1page deck': ['ì œì¡°_ì†”ë£¨ì…˜_1page.pdf'],
                    'PR FAQ': ['Manufacturing_FAQ_KR.pdf'],
                    'Charter': ['Smart_Factory_Charter.pdf'],
                    'Demo ì˜ìƒ': ['Smart_Factory_Demo.mp4', 'Quality_Control_AI_Demo.mp4']
                },
                'ìœ í†µ': {
                    'ì œì•ˆì„œ': ['Retail_AI_Platform_Proposal.pptx', 'Omnichannel_Solution.pdf'],
                    'Brochure': ['ìœ í†µ_í˜ì‹ _ë¸Œë¡œì…”_2024.pdf', 'Retail_AI_Overview.pdf'],
                    'Customer Case': ['Lotte_Retail_Case.pdf', 'GS_Retail_Success.pdf', 'Emart_Implementation.pdf'],
                    '1page deck': ['Retail_Platform_Brief.pdf'],
                    'PR FAQ': ['Retail_AI_FAQ.pdf'],
                    'Charter': ['Retail_Digital_Charter.pdf'],
                    'Demo ì˜ìƒ': ['Omnichannel_Experience_Demo.mp4', 'Smart_Store_Demo.mp4']
                },
                'Emerging biz & Game': {
                    'ì œì•ˆì„œ': ['Game_AI_Platform_Proposal.pptx', 'Content_Creator_Solution.pdf'],
                    'Brochure': ['Gaming_AI_Brochure.pdf', 'Creator_Economy_Overview.pdf'],
                    'Customer Case': ['Nexon_Game_Case.pdf', 'NCsoft_AI_Story.pdf'],
                    '1page deck': ['Gaming_AI_Brief.pdf'],
                    'PR FAQ': ['Game_Platform_FAQ.pdf'],
                    'Charter': ['Gaming_Innovation_Charter.pdf'],
                    'Demo ì˜ìƒ': ['AI_NPC_Behavior_Demo.mp4', 'Game_Balance_AI_Demo.mp4']
                },
                'Public': {
                    'ì œì•ˆì„œ': ['Public_Sector_AI_Proposal.pptx', 'Government_Solution.pdf'],
                    'Brochure': ['Public_Sector_Brochure.pdf'],
                    'Customer Case': ['Seoul_City_Case.pdf', 'Ministry_Implementation.pdf'],
                    '1page deck': ['Public_Sector_Brief.pdf'],
                    'PR FAQ': ['Public_Sector_FAQ.pdf'],
                    'Charter': ['Public_AI_Charter.pdf'],
                    'Demo ì˜ìƒ': ['Smart_City_Dashboard_Demo.mp4', 'Citizen_Service_AI_Demo.mp4']
                },
                'Telco&Media': {
                    'ì œì•ˆì„œ': ['5G_AI_Platform_Proposal.pptx', 'Media_Analytics_Solution.pdf'],
                    'Brochure': ['Telco_Media_Brochure.pdf'],
                    'Customer Case': ['SKT_Implementation.pdf', 'KT_Success_Story.pdf'],
                    '1page deck': ['Telco_Solution_Brief.pdf'],
                    'PR FAQ': ['Telco_Platform_FAQ.pdf'],
                    'Charter': ['5G_AI_Project_Charter.pdf'],
                    'Demo ì˜ìƒ': ['5G_Network_Optimization_Demo.mp4', 'Content_Recommendation_Demo.mp4']
                },
                'Vertical Enterprise': {
                    'ì œì•ˆì„œ': ['Enterprise_AI_Platform_Proposal.pptx', 'Cross_Functional_Solution.pdf'],
                    'Brochure': ['Enterprise_Solution_Brochure.pdf'],
                    'Customer Case': ['Lotte_Group_Case.pdf', 'Doosan_Implementation.pdf'],
                    '1page deck': ['Enterprise_Platform_1pager.pdf'],
                    'PR FAQ': ['Enterprise_FAQ.pdf'],
                    'Charter': ['Enterprise_AI_Charter.pdf'],
                    'Demo ì˜ìƒ': ['Enterprise_Document_Management_Demo.mp4', 'HR_Process_Automation_Demo.mp4']
                }
            };

            // ë°œí‘œìžë£Œ ì´ˆê¸° ë°ì´í„°
            const initialPresentationData = {
                events: [
                    { id: 1, name: 'AWS Summit Seoul' },
                    { id: 2, name: 'Google Cloud Next' },
                    { id: 3, name: 'Microsoft Ignite' },
                    { id: 4, name: 'AI Expo Korea' },
                    { id: 5, name: 'Digital Transformation Forum' }
                ],
                schedule: {
                    1: { 3: 'AI Platform ì†Œê°œ', 6: 'Case Study ë°œí‘œ' },
                    2: { 5: 'Cloud AI ì„¸ì…˜', 9: 'ê¸°ìˆ  ì›Œí¬ìƒµ' },
                    3: { 2: 'Enterprise AI', 11: 'Partner Summit' },
                    4: { 4: 'AIR Studio Demo', 7: 'Industry Session', 10: 'ì—°ë§ ì»¨í¼ëŸ°ìŠ¤' },
                    5: { 1: 'ì‹ ë…„ ì„¸ë¯¸ë‚˜', 6: 'ì¤‘ê°„ ë¦¬ë·°', 12: 'ì„±ê³¼ ê³µìœ ' }
                }
            };

            const [agentData, setAgentData] = useState(() => {
                const saved = localStorage.getItem('agentDataV7');
                return saved ? JSON.parse(saved) : initialAgentData;
            });

            const [saleskitData, setSaleskitData] = useState(() => {
                const saved = localStorage.getItem('saleskitDataV7');
                return saved ? JSON.parse(saved) : initialSaleskitData;
            });

            const [presentationData, setPresentationData] = useState(() => {
                const saved = localStorage.getItem('presentationDataV1');
                return saved ? JSON.parse(saved) : initialPresentationData;
            });

            useEffect(() => {
                localStorage.setItem('agentDataV7', JSON.stringify(agentData));
            }, [agentData]);

            useEffect(() => {
                localStorage.setItem('saleskitDataV7', JSON.stringify(saleskitData));
            }, [saleskitData]);

            useEffect(() => {
                localStorage.setItem('presentationDataV1', JSON.stringify(presentationData));
            }, [presentationData]);

            useEffect(() => {
                localStorage.setItem('agentMemosV1', JSON.stringify(agentMemos));
            }, [agentMemos]);

            useEffect(() => {
                localStorage.setItem('agentColorsV1', JSON.stringify(agentColors));
            }, [agentColors]);

            useEffect(() => {
                if (selectedIndustry && activeTab === 'agent') {
                    const workflows = industrySpecificWorkflows[selectedIndustry];
                    if (workflows && workflows.length > 0) {
                        setSelectedWorkflow(workflows[0]);
                    }
                }
            }, [selectedIndustry, activeTab]);

            useEffect(() => {
                if (!editMode) {
                    setEditingItem(null);
                    setEditValue('');
                }
            }, [editMode]);

            const currentData = activeTab === 'agent' ? agentData : saleskitData;
            const currentDriveLink = activeTab === 'agent' ? AGENT_DRIVE_LINK : SALESKIT_DRIVE_LINK;
            const saleskitCategories = ['ì œì•ˆì„œ', 'Brochure', 'Customer Case', '1page deck', 'PR FAQ', 'Charter', 'Demo ì˜ìƒ'];
            const industries = ['FSI', 'ì œì¡°', 'ìœ í†µ', 'Emerging biz & Game', 'Public', 'Telco&Media', 'Vertical Enterprise'];

            const workflowColors = {
                'ê³ ê° ìƒë‹´': '#9333ea', 'ë¬¸ì„œ ê´€ë¦¬': '#64748b', 'ë°ì´í„° ë¶„ì„': '#f59e0b', 'ì˜ì‚¬ê²°ì • ì§€ì›': '#ec4899',
                'ë³´ê³ ì„œ ìƒì„±': '#6366f1', 'HR í”„ë¡œì„¸ìŠ¤': '#14b8a6',
                'ê³ ê° ì˜¨ë³´ë”©': '#2563eb', 'ëŒ€ì¶œ/ì‹¬ì‚¬': '#dc2626', 'ìžì‚° ê´€ë¦¬': '#16a34a', 'ê³ ê° ì´íƒˆ ë°©ì§€': '#ea580c', 'ê´‘ê³  ìµœì í™”': '#0891b2',
                'ìˆ˜ìš” ì˜ˆì¸¡': '#2563eb', 'ìƒì‚° ê³„íš': '#dc2626', 'í’ˆì§ˆ ê´€ë¦¬': '#16a34a', 'ì„¤ë¹„ ìœ ì§€ë³´ìˆ˜': '#7c3aed',
                'ìž¬ê³  ê´€ë¦¬': '#2563eb', 'ë§¤ìž¥ ìš´ì˜': '#dc2626', 'ê³ ê° ê²½í—˜': '#16a34a', 'ì˜´ë‹ˆì±„ë„': '#7c3aed',
                'ê²Œìž„ ê°œë°œ': '#2563eb', 'ì½˜í…ì¸  ì œìž‘': '#dc2626', 'ì»¤ë®¤ë‹ˆí‹° ê´€ë¦¬': '#16a34a', 'ìˆ˜ìµí™” ì „ëžµ': '#7c3aed',
                'ë¯¼ì› ì²˜ë¦¬': '#2563eb', 'ì •ì±… ë¶„ì„': '#dc2626', 'ì˜ˆì‚° ê´€ë¦¬': '#16a34a', 'ê³µê³µ ì„œë¹„ìŠ¤': '#7c3aed',
                'ì½˜í…ì¸  ì¶”ì²œ': '#2563eb', 'ë„¤íŠ¸ì›Œí¬ ìµœì í™”': '#dc2626',
                'êµ¬ë§¤ ê´€ë¦¬': '#dc2626', 'ì§€ì‹ ê´€ë¦¬': '#16a34a', 'í”„ë¡œì„¸ìŠ¤ ìžë™í™”': '#7c3aed'
            };

            const handleItemClick = (itemName) => {
                setClickedItem(itemName);
                window.open(currentDriveLink, '_blank', 'noopener,noreferrer');
                setTimeout(() => setClickedItem(null), 2000);
            };

            const handleResetData = () => {
                if (!isAdmin) { alert(t.loginRequired); return; }
                if (confirm(t.resetConfirm)) {
                    if (activeTab === 'agent') {
                        setAgentData(initialAgentData);
                        localStorage.setItem('agentDataV7', JSON.stringify(initialAgentData));
                    } else if (activeTab === 'saleskit') {
                        setSaleskitData(initialSaleskitData);
                        localStorage.setItem('saleskitDataV7', JSON.stringify(initialSaleskitData));
                    } else if (activeTab === 'presentation') {
                        setPresentationData(initialPresentationData);
                        localStorage.setItem('presentationDataV1', JSON.stringify(initialPresentationData));
                    }
                }
            };

            // ë°œí‘œìžë£Œ - í–‰ì‚¬ ì¶”ê°€
            const handleAddEvent = () => {
                if (newEventName.trim()) {
                    const newId = Math.max(...presentationData.events.map(e => e.id), 0) + 1;
                    setPresentationData(prev => ({
                        ...prev,
                        events: [...prev.events, { id: newId, name: newEventName.trim() }],
                        schedule: { ...prev.schedule, [newId]: {} }
                    }));
                    setNewEventName('');
                    setShowAddEventModal(false);
                }
            };

            // ë°œí‘œìžë£Œ - í–‰ì‚¬ ì‚­ì œ
            const handleDeleteEvent = (eventId) => {
                if (confirm('ì´ í–‰ì‚¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    setPresentationData(prev => {
                        const newSchedule = { ...prev.schedule };
                        delete newSchedule[eventId];
                        return {
                            ...prev,
                            events: prev.events.filter(e => e.id !== eventId),
                            schedule: newSchedule
                        };
                    });
                }
            };

            // ë°œí‘œìžë£Œ - ì…€ íŽ¸ì§‘ ì €ìž¥
            const handleSaveCellEdit = () => {
                if (editingCell) {
                    const { eventId, month } = editingCell;
                    setPresentationData(prev => {
                        const newSchedule = { ...prev.schedule };
                        if (!newSchedule[eventId]) newSchedule[eventId] = {};
                        if (editCellValue.trim()) {
                            newSchedule[eventId][month] = editCellValue.trim();
                        } else {
                            delete newSchedule[eventId][month];
                        }
                        return { ...prev, schedule: newSchedule };
                    });
                    setEditingCell(null);
                    setEditCellValue('');
                }
            };

            // ë°œí‘œìžë£Œ - í–‰ì‚¬ëª… íŽ¸ì§‘
            const handleEditEventName = (eventId, currentName) => {
                if (!isAdmin) return;
                setEditingEventName(eventId);
                setEditEventNameValue(currentName);
            };

            const handleSaveEventName = () => {
                if (editingEventName && editEventNameValue.trim()) {
                    setPresentationData(prev => ({
                        ...prev,
                        events: prev.events.map(e => 
                            e.id === editingEventName 
                                ? { ...e, name: editEventNameValue.trim() } 
                                : e
                        )
                    }));
                }
                setEditingEventName(null);
                setEditEventNameValue('');
            };

            const handleCancelEventNameEdit = () => {
                setEditingEventName(null);
                setEditEventNameValue('');
            };

            // ë°œí‘œìžë£Œ - ì…€ ê°’ í´ë¦­ ì‹œ Google Drive ì—´ê¸°
            const handlePresentationCellClick = (cellValue) => {
                if (cellValue && !editMode) {
                    window.open(PRESENTATION_DRIVE_LINK, '_blank', 'width=1200,height=800');
                    setClickedItem(cellValue);
                    setTimeout(() => setClickedItem(null), 2000);
                }
            };

            // ë°œí‘œìžë£Œ - Google Pickerë¡œ íŒŒì¼ ì„ íƒ
            const openPresentationPicker = () => {
                if (GOOGLE_API_KEY === 'YOUR_API_KEY_HERE' || GOOGLE_CLIENT_ID === 'YOUR_CLIENT_ID_HERE') {
                    // API í‚¤ê°€ ì—†ìœ¼ë©´ Drive ë§í¬ ì—´ê¸°
                    window.open(PRESENTATION_DRIVE_LINK, '_blank', 'width=1200,height=800');
                    return;
                }

                if (!pickerApiLoaded || !googleToken) {
                    handleAuthClick();
                    setTimeout(() => openPresentationPicker(), 1000);
                    return;
                }

                const picker = new window.google.picker.PickerBuilder()
                    .addView(
                        new window.google.picker.DocsView()
                            .setParent(PRESENTATION_FOLDER_ID)
                            .setIncludeFolders(false)
                    )
                    .setOAuthToken(googleToken)
                    .setDeveloperKey(GOOGLE_API_KEY)
                    .setCallback((data) => {
                        if (data.action === window.google.picker.Action.PICKED) {
                            const file = data.docs[0];
                            setEditCellValue(file.name);
                        }
                    })
                    .setTitle('íŒŒì¼ ì„ íƒ')
                    .build();
                
                picker.setVisible(true);
            };

            // Agent ë©”ëª¨ í•¨ìˆ˜ë“¤
            const getMemoKey = (industry, workflow, agent) => {
                return `${industry}|||${workflow}|||${agent}`;
            };

            const handleOpenMemo = (industry, workflow, agent) => {
                const key = getMemoKey(industry, workflow, agent);
                setCurrentMemo({
                    industry,
                    workflow,
                    agent,
                    text: agentMemos[key] || ''
                });
                setShowMemoModal(true);
            };

            const handleSaveMemo = () => {
                const key = getMemoKey(currentMemo.industry, currentMemo.workflow, currentMemo.agent);
                setAgentMemos(prev => ({
                    ...prev,
                    [key]: currentMemo.text
                }));
                setShowMemoModal(false);
            };

            const handleDeleteMemo = () => {
                const key = getMemoKey(currentMemo.industry, currentMemo.workflow, currentMemo.agent);
                setAgentMemos(prev => {
                    const newMemos = { ...prev };
                    delete newMemos[key];
                    return newMemos;
                });
                setShowMemoModal(false);
            };

            const hasMemo = (industry, workflow, agent) => {
                const key = getMemoKey(industry, workflow, agent);
                return agentMemos[key] && agentMemos[key].trim() !== '';
            };

            const getAgentColor = (industry, workflow, agent) => {
                const key = getMemoKey(industry, workflow, agent);
                return agentColors[key] || 'black';
            };

            const setAgentColor = (industry, workflow, agent, color) => {
                const key = getMemoKey(industry, workflow, agent);
                setAgentColors(prev => ({
                    ...prev,
                    [key]: color
                }));
            };

            const industryColors = {
                'FSI': { bg: 'bg-blue-600', hex: '#2563eb' },
                'ì œì¡°': { bg: 'bg-orange-600', hex: '#ea580c' },
                'ìœ í†µ': { bg: 'bg-rose-600', hex: '#e11d48' },
                'Emerging biz & Game': { bg: 'bg-lime-600', hex: '#65a30d' },
                'Public': { bg: 'bg-indigo-600', hex: '#4f46e5' },
                'Telco&Media': { bg: 'bg-purple-600', hex: '#9333ea' },
                'Vertical Enterprise': { bg: 'bg-teal-600', hex: '#0d9488' }
            };

            const itemsByIndustry = useMemo(() => {
                const result = {};
                Object.entries(currentData).forEach(([industry, workflows]) => {
                    result[industry] = new Set();
                    Object.values(workflows).forEach(items => {
                        if (items) items.forEach(item => { if (item !== 'ì—†ìŒ') result[industry].add(item); });
                    });
                });
                return result;
            }, [currentData]);

            const totalItems = useMemo(() => {
                const all = new Set();
                Object.values(itemsByIndustry).forEach(set => set.forEach(item => all.add(item)));
                return all;
            }, [itemsByIndustry]);

            // Icons
            const SearchIcon = () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path>
                </svg>
            );
            const ZoomInIcon = () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path>
                    <line x1="11" y1="8" x2="11" y2="14"></line><line x1="8" y1="11" x2="14" y2="11"></line>
                </svg>
            );
            const ZoomOutIcon = () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path>
                    <line x1="8" y1="11" x2="14" y2="11"></line>
                </svg>
            );
            const ExternalLinkIcon = ({ size = 18 }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                    <polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
                </svg>
            );
            const EditIcon = ({ size = 16 }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                </svg>
            );
            const TrashIcon = ({ size = 16 }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <polyline points="3 6 5 6 21 6"></polyline>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
            );
            const PlusIcon = ({ size = 20 }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
            );
            const MessageSquareIcon = ({ size = 16 }) => (
                <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                </svg>
            );
            const GlobeIcon = () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                    <circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line>
                    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                </svg>
            );
            const ArrowRightIcon = () => (
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3">
                    <path d="M5 12h14"></path><path d="m12 5 7 7-7 7"></path>
                </svg>
            );

            // Workflow Diagram Map
            const WorkflowDiagramMap = ({ industry }) => {
                const specificWorkflows = industrySpecificWorkflows[industry] || [];
                const data = currentData[industry];

                return (
                    <div className="space-y-6">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-4">
                                <div className={`w-14 h-14 rounded-2xl ${industryColors[industry].bg} flex items-center justify-center text-white shadow-lg text-2xl font-bold`}>
                                    {translateIndustry(industry).charAt(0)}
                                </div>
                                <div>
                                    <h2 className="text-2xl font-bold text-gray-900">{translateIndustry(industry)}</h2>
                                    <p className="text-gray-500">{t.industryWorkflowTitle}</p>
                                </div>
                            </div>
                            <button onClick={() => { setSelectedIndustry(null); setSelectedWorkflow(null); }}
                                className="px-5 py-2.5 bg-gray-800 text-white rounded-xl hover:bg-gray-900 transition-all shadow-lg font-semibold">
                                {t.backToOverview}
                            </button>
                        </div>

                        <div className="bg-white rounded-2xl shadow-lg border border-gray-200 p-6">
                            <h3 className="text-lg font-bold text-gray-900 mb-2">{t.workflowDiagram}</h3>
                            <p className="text-sm text-gray-500 mb-6">{t.clickWorkflow}</p>
                            
                            <div className="flex items-center justify-center flex-wrap gap-2">
                                {specificWorkflows.map((wf, idx) => {
                                    const isSelected = selectedWorkflow === wf;
                                    const isHovered = hoveredWorkflow === wf;
                                    const agentCount = (data[wf] || []).length;
                                    
                                    return (
                                        <React.Fragment key={wf}>
                                            <div
                                                className={`relative cursor-pointer transition-all duration-300 ${isSelected ? 'scale-110 z-10' : isHovered ? 'scale-105' : ''}`}
                                                onMouseEnter={() => setHoveredWorkflow(wf)}
                                                onMouseLeave={() => setHoveredWorkflow(null)}
                                                onClick={() => setSelectedWorkflow(wf)}
                                            >
                                                <div className={`px-5 py-4 rounded-2xl text-white font-bold shadow-lg transition-all ${isSelected ? 'ring-4 ring-offset-2' : ''}`}
                                                    style={{ backgroundColor: workflowColors[wf], ringColor: workflowColors[wf] }}>
                                                    <div className="text-center">
                                                        <div className="text-sm font-bold whitespace-nowrap">{translateWorkflow(wf)}</div>
                                                        <div className="text-xs opacity-80 mt-1">{agentCount} Agents</div>
                                                    </div>
                                                </div>
                                                <div className="absolute -top-2 -left-2 w-7 h-7 rounded-full bg-white shadow-md flex items-center justify-center text-sm font-bold"
                                                    style={{ color: workflowColors[wf] }}>{idx + 1}</div>
                                            </div>
                                            {idx < specificWorkflows.length - 1 && (
                                                <div className="text-gray-300 flow-arrow mx-1"><ArrowRightIcon /></div>
                                            )}
                                        </React.Fragment>
                                    );
                                })}
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl shadow-lg border border-gray-200 overflow-hidden">
                            {selectedWorkflow ? (
                                <>
                                    <div className="px-6 py-4 text-white" style={{ backgroundColor: workflowColors[selectedWorkflow] }}>
                                        <div className="flex items-center justify-between">
                                            <div className="flex items-center gap-3">
                                                <div className="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center font-bold text-lg">
                                                    {specificWorkflows.indexOf(selectedWorkflow) + 1}
                                                </div>
                                                <div>
                                                    <h3 className="text-xl font-bold">{translateWorkflow(selectedWorkflow)}</h3>
                                                    <p className="text-white/80 text-sm">{t.agentList}</p>
                                                </div>
                                            </div>
                                            <div className="flex items-center gap-3">
                                                <div className="text-white/80 text-sm">{(data[selectedWorkflow] || []).length} Agents</div>
                                                {editMode && isAdmin && (
                                                    <button
                                                        onClick={() => handleOpenAddModalWithPicker(selectedIndustry, selectedWorkflow)}
                                                        className="px-3 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg font-semibold text-sm transition-all flex items-center gap-2"
                                                        title="Agent ì¶”ê°€"
                                                    >
                                                        <PlusIcon size={18} />
                                                        ì¶”ê°€
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                    </div>
                                    <div className="p-6">
                                        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3">
                                            {(data[selectedWorkflow] || [])
                                                .filter(agent => !searchTerm || agent.toLowerCase().includes(searchTerm.toLowerCase()))
                                                .map((agent, idx) => {
                                                    const isEditing = editingItem?.industry === selectedIndustry && 
                                                                    editingItem?.workflow === selectedWorkflow && 
                                                                    editingItem?.itemIndex === idx;
                                                    
                                                    if (isEditing) {
                                                        return (
                                                            <div key={`${agent}-${idx}`} className="p-4 bg-white rounded-xl border-2 border-blue-400">
                                                                <input
                                                                    type="text"
                                                                    value={editValue}
                                                                    onChange={(e) => setEditValue(e.target.value)}
                                                                    onKeyPress={(e) => e.key === 'Enter' && handleSaveEdit()}
                                                                    className="w-full px-2 py-1 border border-gray-300 rounded text-sm mb-2"
                                                                    autoFocus
                                                                    placeholder="AI Agent ëª…ì„ ìž…ë ¥í•˜ì„¸ìš” (í•œê¸€/ì˜ë¬¸)"
                                                                />
                                                                <div className="flex gap-2 mb-2">
                                                                    <span className="text-xs text-gray-600 font-semibold">ê¸€ê¼´ ìƒ‰ìƒ:</span>
                                                                    <button
                                                                        onClick={() => setEditingItem({...editingItem, color: 'black'})}
                                                                        className={`px-3 py-1 rounded text-xs font-semibold transition-all ${
                                                                            editingItem?.color === 'black' 
                                                                                ? 'bg-gray-800 text-white' 
                                                                                : 'bg-gray-200 text-gray-800 hover:bg-gray-300'
                                                                        }`}
                                                                    >
                                                                        ê²€ì€ìƒ‰
                                                                    </button>
                                                                    <button
                                                                        onClick={() => setEditingItem({...editingItem, color: 'blue'})}
                                                                        className={`px-3 py-1 rounded text-xs font-semibold transition-all ${
                                                                            editingItem?.color === 'blue' 
                                                                                ? 'bg-blue-600 text-white' 
                                                                                : 'bg-blue-100 text-blue-800 hover:bg-blue-200'
                                                                        }`}
                                                                    >
                                                                        íŒŒëž€ìƒ‰
                                                                    </button>
                                                                </div>
                                                                <div className="flex gap-1">
                                                                    <button onClick={handleSaveEdit} className="flex-1 py-1 bg-green-500 text-white rounded text-xs font-semibold">
                                                                        {t.save}
                                                                    </button>
                                                                    <button onClick={handleCancelEdit} className="flex-1 py-1 bg-gray-500 text-white rounded text-xs font-semibold">
                                                                        {t.cancel}
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        );
                                                    }
                                                    
                                                    return (
                                                        <div key={`${agent}-${idx}`}
                                                            className={`p-4 rounded-xl border-2 transition-all ${
                                                                editMode ? 'bg-gray-50 border-gray-300' :
                                                                clickedItem === agent ? 'bg-green-50 border-green-400' : 
                                                                'bg-gray-50 border-gray-200 hover:border-blue-400 cursor-pointer hover:shadow-lg hover:scale-[1.02]'
                                                            }`}>
                                                            <div className="flex items-start gap-3">
                                                                <div className="w-8 h-8 rounded-lg flex items-center justify-center text-white font-bold text-sm flex-shrink-0"
                                                                    style={{ backgroundColor: workflowColors[selectedWorkflow] }}>{idx + 1}</div>
                                                                <div className="flex-1 min-w-0">
                                                                    <p 
                                                                        className="font-medium text-sm truncate" 
                                                                        title={agent}
                                                                        style={{ color: getAgentColor(selectedIndustry, selectedWorkflow, agent) === 'blue' ? '#2563eb' : '#111827' }}
                                                                    >
                                                                        {agent}
                                                                    </p>
                                                                    
                                                                    {/* ë©”ëª¨ í‘œì‹œ (ì¼ë°˜ ëª¨ë“œ & ë©”ëª¨ ìžˆì„ ë•Œ) */}
                                                                    {!editMode && hasMemo(selectedIndustry, selectedWorkflow, agent) && (
                                                                        <div className="mt-2 p-2 bg-blue-50 border border-blue-200 rounded-lg relative">
                                                                            <div className="absolute -top-1 left-3 w-2 h-2 bg-blue-50 border-l border-t border-blue-200 transform rotate-45"></div>
                                                                            <p className="text-xs text-blue-800 leading-relaxed">
                                                                                {agentMemos[getMemoKey(selectedIndustry, selectedWorkflow, agent)]}
                                                                            </p>
                                                                        </div>
                                                                    )}
                                                                    
                                                                    {!editMode && (
                                                                        <div className="flex items-center gap-2 mt-1">
                                                                            <p className="text-xs text-gray-500 flex items-center gap-1 cursor-pointer" onClick={() => handleItemClick(agent)}>
                                                                                <ExternalLinkIcon size={12} />{t.clickToConnect}
                                                                            </p>
                                                                            <button
                                                                                onClick={() => handleOpenMemo(selectedIndustry, selectedWorkflow, agent)}
                                                                                className={`p-1 rounded transition-colors ${
                                                                                    hasMemo(selectedIndustry, selectedWorkflow, agent)
                                                                                        ? 'bg-blue-100 text-blue-600 hover:bg-blue-200'
                                                                                        : 'bg-gray-100 text-gray-400 hover:bg-gray-200'
                                                                                }`}
                                                                                title="ë©”ëª¨"
                                                                            >
                                                                                <MessageSquareIcon size={14} />
                                                                            </button>
                                                                        </div>
                                                                    )}
                                                                    {editMode && isAdmin && (
                                                                        <div className="flex gap-1 mt-2">
                                                                            <button
                                                                                onClick={() => handleEditItem(selectedIndustry, selectedWorkflow, idx, agent)}
                                                                                className="p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                                                                                title="ìˆ˜ì •"
                                                                            >
                                                                                <EditIcon size={16} />
                                                                            </button>
                                                                            <button
                                                                                onClick={() => handleDeleteItem(selectedIndustry, selectedWorkflow, idx)}
                                                                                className="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
                                                                                title="ì‚­ì œ"
                                                                            >
                                                                                <TrashIcon size={16} />
                                                                            </button>
                                                                            <button
                                                                                onClick={() => handleOpenMemo(selectedIndustry, selectedWorkflow, agent)}
                                                                                className={`p-2 rounded-lg transition-colors ${
                                                                                    hasMemo(selectedIndustry, selectedWorkflow, agent)
                                                                                        ? 'bg-blue-500 text-white hover:bg-blue-600'
                                                                                        : 'bg-gray-400 text-white hover:bg-gray-500'
                                                                                }`}
                                                                                title="ë©”ëª¨"
                                                                            >
                                                                                <MessageSquareIcon size={16} />
                                                                            </button>
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            </div>
                                                        </div>
                                                    );
                                                })}
                                        </div>
                                    </div>
                                </>
                            ) : (
                                <div className="p-12 text-center text-gray-500">
                                    <div className="text-4xl mb-4">ðŸ‘†</div>
                                    <p>{t.selectWorkflow}</p>
                                </div>
                            )}
                        </div>
                    </div>
                );
            };

            // Overview Table
            const OverviewTable = () => {
                const workflows = activeTab === 'agent' ? commonWorkflows : saleskitCategories;

                return (
                    <div className="space-y-4">
                        {activeTab === 'agent' && (
                            <div className="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-200">
                                <div className="flex items-center gap-3">
                                    <span className="text-2xl">ðŸš‡</span>
                                    <div>
                                        <p className="font-semibold text-gray-900">{t.clickForMap}</p>
                                        <p className="text-sm text-gray-600">ìƒë‹¨ ì‚°ì—…êµ° ì¹´ë“œ í´ë¦­ ì‹œ í•´ë‹¹ ì‚°ì—…ì˜ íŠ¹í™” Workflow Mapì„ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {activeTab === 'agent' && (
                            <h3 className="text-lg font-bold text-gray-800 flex items-center gap-2">ðŸ“‹ {t.commonWorkflowTitle}</h3>
                        )}

                        <div className="bg-white rounded-xl shadow-xl overflow-hidden border border-gray-200" style={{ fontSize: `${zoom}%` }}>
                            <div className="overflow-x-auto">
                                <table className="w-full border-collapse">
                                    <thead>
                                        <tr>
                                            <th className="sticky left-0 z-20 bg-gray-900 text-white px-4 py-4 text-left font-bold border-r-2 border-gray-700 min-w-[130px]">
                                                {t.workflowLabel} / {t.industryLabel}
                                            </th>
                                            {industries.map((industry, idx) => (
                                                <th key={idx} 
                                                    className={`${industryColors[industry].bg} text-white px-3 py-3 text-center font-bold border-r border-gray-700 min-w-[150px] cursor-pointer hover:opacity-90 transition-all`}
                                                    onClick={() => activeTab === 'agent' && setSelectedIndustry(industry)}>
                                                    <div className="flex flex-col items-center">
                                                        <span className="text-sm font-bold">{translateIndustry(industry)}</span>
                                                        <span className="text-xs opacity-90 mt-0.5">{itemsByIndustry[industry]?.size || 0} {activeTab === 'agent' ? t.agents : t.files}</span>
                                                        {activeTab === 'agent' && (
                                                            <span className="text-[10px] opacity-80 mt-1 bg-white/20 px-2 py-0.5 rounded-full">ðŸš‡ Workflow Map</span>
                                                        )}
                                                    </div>
                                                </th>
                                            ))}
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {workflows.map((workflow, rowIdx) => (
                                            <tr key={rowIdx} className="border-b border-gray-200 hover:bg-gray-50">
                                                <td className="sticky left-0 z-10 bg-gray-800 text-white px-4 py-3 font-semibold border-r-2 border-gray-600 text-sm">
                                                    <div className="flex items-center gap-2">
                                                        {activeTab === 'agent' && (
                                                            <div className="w-3 h-3 rounded-full" style={{ backgroundColor: workflowColors[workflow] || '#6b7280' }}></div>
                                                        )}
                                                        {translateWorkflow(workflow)}
                                                    </div>
                                                </td>
                                                {industries.map((industry, colIdx) => {
                                                    const items = currentData[industry]?.[workflow] || [];
                                                    const displayItems = searchTerm ? items.filter(i => i.toLowerCase().includes(searchTerm.toLowerCase())) : items;

                                                    return (
                                                        <td key={colIdx} className="px-2 py-2 border-r border-gray-200 bg-gray-50 align-top">
                                                            {displayItems.length === 0 && !editMode ? (
                                                                <div className="text-center text-gray-400 text-xs py-2">{t.noData}</div>
                                                            ) : (
                                                                <div className="space-y-1">
                                                                    <div className="flex items-center justify-between mb-1">
                                                                        <div className="text-xs text-gray-500 font-semibold">
                                                                            {displayItems.length} {activeTab === 'agent' ? t.agents : t.files}
                                                                        </div>
                                                                        {editMode && isAdmin && (
                                                                            <button
                                                                                onClick={() => handleOpenAddModalWithPicker(industry, workflow)}
                                                                                className="p-1 bg-green-500 text-white rounded-full hover:bg-green-600 transition-colors"
                                                                                title="í•­ëª© ì¶”ê°€"
                                                                            >
                                                                                <PlusIcon size={18} />
                                                                            </button>
                                                                        )}
                                                                    </div>
                                                                    {displayItems.map((item, itemIdx) => {
                                                                        const isEditing = editingItem?.industry === industry && 
                                                                                        editingItem?.workflow === workflow && 
                                                                                        editingItem?.itemIndex === itemIdx;
                                                                        
                                                                        if (isEditing) {
                                                                            return (
                                                                                <div key={itemIdx} className="space-y-1">
                                                                                    <input
                                                                                        type="text"
                                                                                        value={editValue}
                                                                                        onChange={(e) => setEditValue(e.target.value)}
                                                                                        onKeyPress={(e) => e.key === 'Enter' && handleSaveEdit()}
                                                                                        className="w-full px-2 py-1 border border-blue-400 rounded text-xs"
                                                                                        autoFocus
                                                                                        placeholder="AI Agent ëª… (í•œê¸€/ì˜ë¬¸)"
                                                                                    />
                                                                                    {activeTab === 'agent' && (
                                                                                        <div className="flex gap-1 items-center">
                                                                                            <span className="text-[10px] text-gray-600">ìƒ‰ìƒ:</span>
                                                                                            <button
                                                                                                onClick={() => setEditingItem({...editingItem, color: 'black'})}
                                                                                                className={`px-2 py-0.5 rounded text-[10px] font-semibold ${
                                                                                                    editingItem?.color === 'black' 
                                                                                                        ? 'bg-gray-800 text-white' 
                                                                                                        : 'bg-gray-200 text-gray-800'
                                                                                                }`}
                                                                                            >
                                                                                                ê²€ì€ìƒ‰
                                                                                            </button>
                                                                                            <button
                                                                                                onClick={() => setEditingItem({...editingItem, color: 'blue'})}
                                                                                                className={`px-2 py-0.5 rounded text-[10px] font-semibold ${
                                                                                                    editingItem?.color === 'blue' 
                                                                                                        ? 'bg-blue-600 text-white' 
                                                                                                        : 'bg-blue-100 text-blue-800'
                                                                                                }`}
                                                                                            >
                                                                                                íŒŒëž€ìƒ‰
                                                                                            </button>
                                                                                        </div>
                                                                                    )}
                                                                                    <div className="flex gap-1">
                                                                                        <button 
                                                                                            onClick={handleSaveEdit} 
                                                                                            className="flex-1 py-0.5 bg-green-500 text-white rounded text-xs font-semibold"
                                                                                        >
                                                                                            {t.save}
                                                                                        </button>
                                                                                        <button 
                                                                                            onClick={handleCancelEdit} 
                                                                                            className="flex-1 py-0.5 bg-gray-500 text-white rounded text-xs font-semibold"
                                                                                        >
                                                                                            {t.cancel}
                                                                                        </button>
                                                                                    </div>
                                                                                </div>
                                                                            );
                                                                        }
                                                                        
                                                                        // íŽ¸ì§‘ ëª¨ë“œê°€ ì•„ë‹ ë•ŒëŠ” ì²˜ìŒ 3ê°œë§Œ, íŽ¸ì§‘ ëª¨ë“œì¼ ë•ŒëŠ” ëª¨ë‘ í‘œì‹œ
                                                                        if (!editMode && itemIdx >= 3) return null;
                                                                        
                                                                        return (
                                                                            <div key={itemIdx} className={editMode ? "space-y-1" : ""}>
                                                                                <div className="flex items-center gap-1">
                                                                                    <button
                                                                                        onClick={() => !editMode && handleItemClick(item)}
                                                                                        disabled={editMode}
                                                                                        className={`flex-1 px-2 py-1.5 bg-white rounded border text-xs text-left transition-all ${
                                                                                            editMode ? 'border-gray-300' :
                                                                                            clickedItem === item ? 'border-green-500 bg-green-50' : 
                                                                                            'hover:shadow-md hover:scale-[1.02] border-gray-200 hover:border-blue-400'
                                                                                        }`}
                                                                                    >
                                                                                        <span 
                                                                                            className="font-medium line-clamp-1"
                                                                                            style={{ 
                                                                                                color: activeTab === 'agent' && getAgentColor(industry, workflow, item) === 'blue' 
                                                                                                    ? '#2563eb' 
                                                                                                    : '#1f2937' 
                                                                                            }}
                                                                                        >
                                                                                            {item}
                                                                                        </span>
                                                                                    </button>
                                                                                    {!editMode && activeTab === 'agent' && (
                                                                                        <button
                                                                                            onClick={() => handleOpenMemo(industry, workflow, item)}
                                                                                            className={`p-1 rounded transition-colors ${
                                                                                                hasMemo(industry, workflow, item)
                                                                                                    ? 'bg-blue-100 text-blue-600 hover:bg-blue-200'
                                                                                                    : 'bg-gray-100 text-gray-400 hover:bg-gray-200'
                                                                                            }`}
                                                                                            title="ë©”ëª¨"
                                                                                        >
                                                                                            <MessageSquareIcon size={12} />
                                                                                        </button>
                                                                                    )}
                                                                                </div>
                                                                                {editMode && isAdmin && (
                                                                                    <div className="flex gap-1">
                                                                                        <button
                                                                                            onClick={() => handleEditItem(industry, workflow, itemIdx, item)}
                                                                                            className="p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                                                                                            title="ìˆ˜ì •"
                                                                                        >
                                                                                            <EditIcon size={14} />
                                                                                        </button>
                                                                                        <button
                                                                                            onClick={() => handleDeleteItem(industry, workflow, itemIdx)}
                                                                                            className="p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors"
                                                                                            title="ì‚­ì œ"
                                                                                        >
                                                                                            <TrashIcon size={14} />
                                                                                        </button>
                                                                                        {activeTab === 'agent' && (
                                                                                            <button
                                                                                                onClick={() => handleOpenMemo(industry, workflow, item)}
                                                                                                className={`p-2 rounded-lg transition-colors ${
                                                                                                    hasMemo(industry, workflow, item)
                                                                                                        ? 'bg-blue-500 text-white hover:bg-blue-600'
                                                                                                        : 'bg-gray-400 text-white hover:bg-gray-500'
                                                                                                }`}
                                                                                                title="ë©”ëª¨"
                                                                                            >
                                                                                                <MessageSquareIcon size={14} />
                                                                                            </button>
                                                                                        )}
                                                                                    </div>
                                                                                )}
                                                                            </div>
                                                                        );
                                                                    })}
                                                                    {displayItems.length > 3 && !editMode && (
                                                                        <div className="text-xs text-gray-500 text-center">
                                                                            +{displayItems.length - 3} more
                                                                        </div>
                                                                    )}
                                                                </div>
                                                            )}
                                                        </td>
                                                    );
                                                })}
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            };

            // Presentation Schedule Table
            const PresentationTable = () => {
                const months = t.months;

                return (
                    <div className="space-y-4">
                        <div className="flex items-center justify-between">
                            <div>
                                <h3 className="text-xl font-bold text-gray-900">{t.presentationTitle}</h3>
                                <p className="text-sm text-gray-500">{t.presentationSubtitle}</p>
                            </div>
                            {editMode && isAdmin && (
                                <button
                                    onClick={() => setShowAddEventModal(true)}
                                    className="flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-all shadow font-semibold"
                                >
                                    <PlusIcon size={18} />
                                    {t.addEvent}
                                </button>
                            )}
                        </div>

                        <div className="bg-white rounded-xl shadow-xl overflow-hidden border border-gray-200">
                            <div className="overflow-x-auto">
                                <table className="w-full border-collapse" style={{ fontSize: `${zoom}%` }}>
                                    <thead>
                                        <tr>
                                            <th className="sticky left-0 z-20 bg-gray-900 text-white px-4 py-4 text-left font-bold border-r-2 border-gray-700 min-w-[200px]">
                                                {t.eventName}
                                            </th>
                                            {months.map((month, idx) => (
                                                <th key={idx} className="bg-indigo-600 text-white px-2 py-3 text-center font-bold border-r border-indigo-500 min-w-[100px]">
                                                    {month}
                                                </th>
                                            ))}
                                            <th className="bg-gray-700 text-white px-3 py-3 text-center font-bold min-w-[80px]">
                                                
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {presentationData.events.map((event, eventIdx) => (
                                            <tr key={event.id} className="border-b border-gray-200 hover:bg-gray-50">
                                                <td className="sticky left-0 z-10 bg-gray-800 text-white px-4 py-3 font-semibold border-r-2 border-gray-600">
                                                    {editingEventName === event.id ? (
                                                        <div className="space-y-2">
                                                            <input
                                                                type="text"
                                                                value={editEventNameValue}
                                                                onChange={(e) => setEditEventNameValue(e.target.value)}
                                                                onKeyPress={(e) => e.key === 'Enter' && handleSaveEventName()}
                                                                className="w-full px-2 py-1 border border-blue-400 rounded text-sm text-gray-900"
                                                                autoFocus
                                                            />
                                                            <div className="flex gap-1">
                                                                <button 
                                                                    onClick={handleSaveEventName} 
                                                                    className="flex-1 py-1 bg-green-500 text-white rounded text-xs font-semibold hover:bg-green-600"
                                                                >
                                                                    ì €ìž¥
                                                                </button>
                                                                <button 
                                                                    onClick={handleCancelEventNameEdit} 
                                                                    className="flex-1 py-1 bg-gray-500 text-white rounded text-xs font-semibold hover:bg-gray-600"
                                                                >
                                                                    ì·¨ì†Œ
                                                                </button>
                                                            </div>
                                                        </div>
                                                    ) : (
                                                        <div className="flex items-center justify-between gap-2">
                                                            <div className="flex items-center gap-2 flex-1">
                                                                <span className="w-6 h-6 rounded-full bg-indigo-500 flex items-center justify-center text-xs font-bold">
                                                                    {eventIdx + 1}
                                                                </span>
                                                                {event.name}
                                                            </div>
                                                            {editMode && isAdmin && (
                                                                <button
                                                                    onClick={() => handleEditEventName(event.id, event.name)}
                                                                    className="p-1.5 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex-shrink-0"
                                                                    title="í–‰ì‚¬ëª… ìˆ˜ì •"
                                                                >
                                                                    <EditIcon size={14} />
                                                                </button>
                                                            )}
                                                        </div>
                                                    )}
                                                </td>
                                                {months.map((_, monthIdx) => {
                                                    const monthNum = monthIdx + 1;
                                                    const cellValue = presentationData.schedule[event.id]?.[monthNum] || '';
                                                    const isEditing = editingCell?.eventId === event.id && editingCell?.month === monthNum;

                                                    return (
                                                        <td key={monthIdx} className="px-2 py-2 border-r border-gray-200 bg-gray-50">
                                                            {isEditing ? (
                                                                <div className="flex flex-col gap-1">
                                                                    <input
                                                                        type="text"
                                                                        value={editCellValue}
                                                                        onChange={(e) => setEditCellValue(e.target.value)}
                                                                        onKeyPress={(e) => e.key === 'Enter' && handleSaveCellEdit()}
                                                                        className="w-full px-2 py-1 border border-blue-400 rounded text-sm focus:ring-2 focus:ring-blue-500 outline-none"
                                                                        autoFocus
                                                                    />
                                                                    <button
                                                                        onClick={openPresentationPicker}
                                                                        className="w-full px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded hover:bg-blue-100 border border-blue-200 font-semibold"
                                                                    >
                                                                        ðŸ“ Driveì—ì„œ íŒŒì¼ ì„ íƒ
                                                                    </button>
                                                                    <div className="flex gap-1">
                                                                        <button onClick={handleSaveCellEdit}
                                                                            className="flex-1 px-2 py-1 bg-green-500 text-white text-xs rounded hover:bg-green-600 font-semibold">
                                                                            {t.save}
                                                                        </button>
                                                                        <button onClick={() => { setEditingCell(null); setEditCellValue(''); }}
                                                                            className="flex-1 px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 font-semibold">
                                                                            {t.cancel}
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            ) : (
                                                                <div
                                                                    className={`min-h-[40px] px-2 py-2 rounded transition-all ${
                                                                        cellValue 
                                                                            ? 'bg-indigo-100 border border-indigo-300 cursor-pointer hover:bg-indigo-200' 
                                                                            : 'bg-gray-100 border border-dashed border-gray-300'
                                                                    } ${editMode && isAdmin ? 'hover:bg-indigo-200' : ''}`}
                                                                    onClick={() => {
                                                                        if (editMode && isAdmin) {
                                                                            setEditingCell({ eventId: event.id, month: monthNum });
                                                                            setEditCellValue(cellValue);
                                                                        } else if (cellValue && !editMode) {
                                                                            handlePresentationCellClick(cellValue);
                                                                        }
                                                                    }}
                                                                    title={editMode && isAdmin ? t.clickToEdit : (cellValue ? 'Google Driveì—ì„œ íŒŒì¼ ì—´ê¸°' : '')}
                                                                >
                                                                    {cellValue ? (
                                                                        <span className="text-sm font-medium text-indigo-800">{cellValue}</span>
                                                                    ) : (
                                                                        <span className="text-xs text-gray-400">+</span>
                                                                    )}
                                                                </div>
                                                            )}
                                                        </td>
                                                    );
                                                })}
                                                <td className="px-2 py-2 bg-gray-100 text-center">
                                                    {editMode && isAdmin && (
                                                        <button
                                                            onClick={() => handleDeleteEvent(event.id)}
                                                            className="p-2 bg-red-500 text-white hover:bg-red-600 rounded-lg transition-colors"
                                                            title={t.deleteEvent}
                                                        >
                                                            <TrashIcon size={16} />
                                                        </button>
                                                    )}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div className="text-xs text-gray-500 text-center">
                            {presentationData.events.length}ê°œ í–‰ì‚¬ Ã— 12ê°œì›”
                        </div>
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-6">
                    {/* Click notification */}
                    {clickedItem && (
                        <div className="fixed top-4 right-4 z-50 bg-green-600 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-3 animate-bounce">
                            <ExternalLinkIcon size={20} />
                            <div>
                                <div className="font-bold">{t.driveOpen}</div>
                                <div className="text-sm opacity-90">{clickedItem}</div>
                            </div>
                        </div>
                    )}

                    {/* Login Modal */}
                    {showLoginModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-xl shadow-2xl max-w-md w-full p-6 animate-slide-in">
                                <h3 className="text-xl font-bold text-gray-900 mb-4">{t.adminLogin}</h3>
                                <div className="mb-4">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">{t.password}</label>
                                    <input type="password" value={password}
                                        onChange={(e) => { setPassword(e.target.value); setLoginError(''); }}
                                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none" autoFocus />
                                    {loginError && <p className="mt-2 text-sm text-red-600">{loginError}</p>}
                                </div>
                                <div className="flex gap-3">
                                    <button onClick={handleLogin} className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">{t.login}</button>
                                    <button onClick={() => { setShowLoginModal(false); setPassword(''); setLoginError(''); }} className="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold">{t.cancel}</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Add Item Modal (AI Agent / Saleskit) */}
                    {showAddModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 animate-slide-in">
                                <h3 className="text-xl font-bold text-gray-900 mb-4">{t.addModalTitle}</h3>
                                
                                {/* Google Picker or Drive ì•ˆë‚´ */}
                                {GOOGLE_API_KEY === 'YOUR_API_KEY_HERE' || GOOGLE_CLIENT_ID === 'YOUR_CLIENT_ID_HERE' ? (
                                    // API í‚¤ê°€ ì—†ì„ ë•Œ - Drive ë§í¬ë¡œ ì•ˆë‚´
                                    <div className="mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg">
                                        <div className="flex items-start gap-3">
                                            <div className="text-2xl">ðŸ“</div>
                                            <div className="flex-1">
                                                <p className="text-sm font-semibold text-blue-900 mb-2">
                                                    Google Drive í´ë” ì—´ê¸°
                                                </p>
                                                <p className="text-xs text-blue-800 mb-2">
                                                    1. ì•„ëž˜ ë²„íŠ¼ìœ¼ë¡œ Driveë¥¼ ì—¬ì„¸ìš”<br/>
                                                    2. íŒŒì¼ëª…ì„ ë³µì‚¬í•˜ì—¬ ìž…ë ¥í•˜ì„¸ìš”
                                                </p>
                                                <button
                                                    onClick={() => {
                                                        const driveLink = activeTab === 'agent' ? AGENT_DRIVE_LINK : SALESKIT_DRIVE_LINK;
                                                        window.open(driveLink, '_blank', 'width=1200,height=800');
                                                    }}
                                                    className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold text-sm"
                                                >
                                                    ðŸ“ Google Drive ì—´ê¸°
                                                </button>
                                                <div className="mt-3 pt-3 border-t border-blue-200">
                                                    <p className="text-xs text-blue-700 font-semibold mb-1">
                                                        ðŸ’¡ Google Picker APIë¥¼ í™œì„±í™”í•˜ë©´ íŒŒì¼ì„ ì§ì ‘ ì„ íƒí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤
                                                    </p>
                                                    <details className="text-xs text-blue-600">
                                                        <summary className="cursor-pointer hover:underline">ì„¤ì • ë°©ë²• ë³´ê¸°</summary>
                                                        <div className="mt-2 p-2 bg-white rounded text-gray-700 space-y-1">
                                                            <p>1. Google Cloud Console ì ‘ì†</p>
                                                            <p>2. APIs & Services â†’ Credentials</p>
                                                            <p>3. API Keyì™€ OAuth Client ID ìƒì„±</p>
                                                            <p>4. Google Picker API í™œì„±í™”</p>
                                                            <p>5. ì½”ë“œì˜ GOOGLE_API_KEYì™€ GOOGLE_CLIENT_ID êµì²´</p>
                                                        </div>
                                                    </details>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                ) : (
                                    // API í‚¤ê°€ ìžˆì„ ë•Œ - Google Picker ë²„íŠ¼
                                    <div className="mb-4 p-4 bg-green-50 border border-green-200 rounded-lg">
                                        <div className="flex items-start gap-3">
                                            <div className="text-2xl">âœ¨</div>
                                            <div className="flex-1">
                                                <p className="text-sm font-semibold text-green-900 mb-2">
                                                    Google Driveì—ì„œ íŒŒì¼ ì„ íƒ
                                                </p>
                                                <p className="text-xs text-green-800 mb-3">
                                                    í´ë¦­í•˜ì—¬ Driveì—ì„œ íŒŒì¼ì„ ì§ì ‘ ì„ íƒí•˜ì„¸ìš”
                                                </p>
                                                <button
                                                    onClick={openPicker}
                                                    className="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold text-sm flex items-center gap-2"
                                                >
                                                    <span>ðŸ“‚</span> Driveì—ì„œ íŒŒì¼ ì„ íƒ
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                <div className="mb-4">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        {addModalCell && `${translateIndustry(addModalCell.industry)} - ${translateWorkflow(addModalCell.workflow)}`}
                                    </label>
                                    <input
                                        type="text"
                                        value={newItemName}
                                        onChange={(e) => setNewItemName(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && handleAddItem()}
                                        placeholder={t.enterName}
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"
                                        autoFocus
                                    />
                                    <p className="text-xs text-gray-500 mt-2">
                                        ì˜ˆì‹œ: FSI_Proposal_Q1_2024.pptx
                                    </p>
                                </div>
                                <div className="flex gap-3">
                                    <button onClick={handleAddItem} className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold">
                                        {t.addButton}
                                    </button>
                                    <button onClick={() => setShowAddModal(false)} className="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold">
                                        {t.cancel}
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Add Event Modal */}
                    {showAddEventModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-xl shadow-2xl max-w-md w-full p-6 animate-slide-in">
                                <h3 className="text-xl font-bold text-gray-900 mb-4">{t.addEventTitle}</h3>
                                <div className="mb-4">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">{t.eventName}</label>
                                    <input type="text" value={newEventName}
                                        onChange={(e) => setNewEventName(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && handleAddEvent()}
                                        placeholder={t.enterEventName}
                                        className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 outline-none" autoFocus />
                                </div>
                                <div className="flex gap-3">
                                    <button onClick={handleAddEvent} className="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold">{t.addEvent}</button>
                                    <button onClick={() => { setShowAddEventModal(false); setNewEventName(''); }} className="flex-1 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold">{t.cancel}</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Agent Memo Modal */}
                    {showMemoModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-xl shadow-2xl max-w-lg w-full p-6 animate-slide-in">
                                <div className="flex items-center gap-3 mb-4">
                                    <div className="p-2 bg-blue-100 rounded-lg">
                                        <MessageSquareIcon size={24} className="text-blue-600" />
                                    </div>
                                    <div>
                                        <h3 className="text-xl font-bold text-gray-900">AI Agent ë©”ëª¨</h3>
                                        <p className="text-sm text-gray-600">{currentMemo.agent}</p>
                                    </div>
                                </div>
                                
                                <div className="mb-4">
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        AI Agent ì†Œê°œ ë¬¸êµ¬
                                    </label>
                                    <textarea
                                        value={currentMemo.text}
                                        onChange={(e) => setCurrentMemo({ ...currentMemo, text: e.target.value })}
                                        placeholder="ì´ AI Agentì— ëŒ€í•œ ì„¤ëª…ì„ ìž…ë ¥í•˜ì„¸ìš”&#10;ì˜ˆ: ê³ ê° ì„œë¹„ìŠ¤ ìžë™í™”ë¥¼ ìœ„í•œ ì±—ë´‡ Agentìž…ë‹ˆë‹¤."
                                        className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none resize-none"
                                        rows="5"
                                        autoFocus
                                    />
                                    <p className="text-xs text-gray-500 mt-2">
                                        ðŸ’¡ ì´ ë©”ëª¨ëŠ” ì›Œí¬í”Œë¡œìš° ìƒì„¸ í™”ë©´ì—ì„œ ë§í’ì„ ìœ¼ë¡œ í‘œì‹œë©ë‹ˆë‹¤
                                    </p>
                                </div>
                                
                                <div className="flex gap-2">
                                    <button 
                                        onClick={handleSaveMemo} 
                                        className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold"
                                    >
                                        ì €ìž¥
                                    </button>
                                    {hasMemo(currentMemo.industry, currentMemo.workflow, currentMemo.agent) && (
                                        <button 
                                            onClick={handleDeleteMemo} 
                                            className="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 font-semibold"
                                            title="ë©”ëª¨ ì‚­ì œ"
                                        >
                                            ì‚­ì œ
                                        </button>
                                    )}
                                    <button 
                                        onClick={() => setShowMemoModal(false)} 
                                        className="px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold"
                                    >
                                        ì·¨ì†Œ
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                    
                    <div className="max-w-[1900px] mx-auto">
                        {/* Header */}
                        <div className="mb-6">
                            <div className="flex items-center justify-between mb-4">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-900 mb-1">{t.title}</h1>
                                    <p className="text-gray-600">{t.subtitle}</p>
                                </div>
                                <div className="flex items-center gap-2">
                                    <button onClick={() => setLanguage(language === 'ko' ? 'en' : 'ko')} className="flex items-center gap-2 px-3 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-800 transition-colors shadow">
                                        <GlobeIcon /><span className="font-semibold text-sm">{language === 'ko' ? 'EN' : 'KO'}</span>
                                    </button>
                                    {isAdmin && (
                                        <button onClick={handleLogout} className="px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 shadow font-semibold text-sm">ðŸ‘¤ {t.logout}</button>
                                    )}
                                    {(activeTab === 'agent' || activeTab === 'saleskit') && (
                                        <button onClick={handleEditModeToggle} className={`px-3 py-2 rounded-lg shadow font-semibold text-sm ${
                                            editMode ? 'bg-red-600 text-white hover:bg-red-700' : 'bg-green-600 text-white hover:bg-green-700'
                                        }`}>
                                            âœï¸ {editMode ? t.editComplete : t.editMode}
                                        </button>
                                    )}
                                    <button onClick={handleResetData} className="px-3 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 shadow font-semibold text-sm"
                                        disabled={!isAdmin} style={{ opacity: isAdmin ? 1 : 0.5 }}>{t.reset}</button>
                                    <div className="flex items-center gap-1 bg-white px-3 py-2 rounded-lg shadow-sm border border-gray-200">
                                        <button onClick={() => setZoom(Math.max(70, zoom - 10))} className="p-1 hover:bg-gray-100 rounded"><ZoomOutIcon /></button>
                                        <span className="text-sm font-semibold min-w-[40px] text-center">{zoom}%</span>
                                        <button onClick={() => setZoom(Math.min(130, zoom + 10))} className="p-1 hover:bg-gray-100 rounded"><ZoomInIcon /></button>
                                    </div>
                                </div>
                            </div>

                            {/* Tabs */}
                            <div className="flex gap-2 mb-4">
                                <button onClick={() => { setActiveTab('agent'); setSearchTerm(''); setSelectedIndustry(null); setSelectedWorkflow(null); }}
                                    className={`px-5 py-2.5 rounded-lg font-bold transition-all ${activeTab === 'agent' ? 'bg-blue-600 text-white shadow-lg scale-105' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>
                                    ðŸ¤– {t.agentTab}
                                </button>
                                <button onClick={() => { setActiveTab('saleskit'); setSearchTerm(''); setSelectedIndustry(null); setSelectedWorkflow(null); }}
                                    className={`px-5 py-2.5 rounded-lg font-bold transition-all ${activeTab === 'saleskit' ? 'bg-purple-600 text-white shadow-lg scale-105' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>
                                    ðŸ“ {t.saleskitTab}
                                </button>
                                <button onClick={() => { setActiveTab('presentation'); setSearchTerm(''); setSelectedIndustry(null); setSelectedWorkflow(null); }}
                                    className={`px-5 py-2.5 rounded-lg font-bold transition-all ${activeTab === 'presentation' ? 'bg-indigo-600 text-white shadow-lg scale-105' : 'bg-white text-gray-700 hover:bg-gray-100'}`}>
                                    ðŸ“Š {t.presentationTab}
                                </button>
                            </div>

                            {/* Stats Cards - Only for agent/saleskit tabs */}
                            {activeTab !== 'presentation' && (
                                <div className="grid grid-cols-8 gap-3 mb-4">
                                    <div className="bg-white rounded-lg p-3 shadow-sm border border-gray-200">
                                        <div className="text-xs text-gray-500">{t.totalAgents}</div>
                                        <div className="text-2xl font-bold text-gray-900">{totalItems.size}</div>
                                    </div>
                                    {industries.map(industry => (
                                        <div key={industry} 
                                            className={`bg-white rounded-lg p-3 shadow-sm border-2 cursor-pointer transition-all hover:shadow-lg hover:scale-[1.03] ${
                                                selectedIndustry === industry ? 'ring-2 ring-blue-500 border-blue-300' : 'border-gray-200'
                                            }`}
                                            onClick={() => activeTab === 'agent' && setSelectedIndustry(industry)}>
                                            <div className="text-xs font-semibold truncate mb-0.5" style={{ color: industryColors[industry].hex }}>
                                                {translateIndustry(industry)}
                                            </div>
                                            <div className="text-xl font-bold text-gray-900">
                                                {itemsByIndustry[industry]?.size || 0}
                                                <span className="text-[10px] text-gray-500 ml-1">{t.agents}</span>
                                            </div>
                                            {activeTab === 'agent' && (
                                                <div className="text-[10px] text-blue-600 mt-1 font-medium">ðŸš‡ Click for map</div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            )}

                            {/* Search - Only for agent/saleskit tabs */}
                            {activeTab !== 'presentation' && (
                                <div className="relative">
                                    <div className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"><SearchIcon /></div>
                                    <input type="text" placeholder={t.searchPlaceholder} value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)}
                                        className="w-full pl-10 pr-4 py-2.5 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 outline-none bg-white shadow-sm" />
                                </div>
                            )}
                        </div>

                        {/* Main Content */}
                        {activeTab === 'presentation' ? (
                            <PresentationTable />
                        ) : activeTab === 'agent' && selectedIndustry ? (
                            <WorkflowDiagramMap industry={selectedIndustry} />
                        ) : (
                            <OverviewTable />
                        )}

                        {/* Footer */}
                        <div className="mt-4 text-xs text-gray-500 text-center">
                            {activeTab === 'presentation' 
                                ? `ë°œí‘œìžë£Œ ì¼ì • ê´€ë¦¬`
                                : selectedIndustry 
                                    ? `${translateIndustry(selectedIndustry)} - íŠ¹í™” Workflow ${industrySpecificWorkflows[selectedIndustry]?.length || 0}ê°œ`
                                    : activeTab === 'agent' 
                                        ? `ê³µí†µ Workflow ${commonWorkflows.length}ê°œ Ã— ${industries.length} ì‚°ì—…êµ°`
                                        : `${saleskitCategories.length} Categories Ã— ${industries.length} Industries`
                            }
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>
